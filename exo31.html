<!doctype html>
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Dyndoc Session</title>

<script src="/rsrc/tools/h/jquery-1.11.3/jquery.min.js"></script>



<link href="/rsrc/tools/uv/solarized.css" media="screen,projection,print" rel="Stylesheet" type="text/css" />
<script src="/rsrc/tools/stat/statInfAEP/distributions.js"></script>
<script src="/rsrc/tools/stat/miniR/miniR.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="/rsrc/tools/css/ascidoctor.css">
<link rel="stylesheet"  href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<script src="/rsrc/tools/clipboard/clipboard.min.js"></script>
<style type="text/css" media="screen">
.demoR:hover {cursor: zoom-in;}
</style>
<script type="text/javascript">
var demoRFigs={};
</script>

<link rel="stylesheet" type="text/css" href="/rsrc/tools/Semantic-UI-CSS/semantic.min.css"><script src="/rsrc/tools/Semantic-UI-CSS/semantic.min.js"></script>





</head>
<body><div class="ui  container">

<div id="content">


<h2> Exercice 31 : Machines </h2>


Un chef d'entreprise désire changer son ancienne machine produisant des pièces d'un certain type au rythme moyen de $1214$ pièces par jour avec un écart-type de $35.4$ pièces par jour. Via l'Approche Expérimentale, ces caractéristiques correspondent respectivement à la moyenne et à l'écart-type des productions quotidiennes obtenues <b>si on pouvait faire tourner cette machine pendant une infinité de jours</b> (il est sous-entendu que le chef d'entreprise ne l'a constaté que pour une période de $m$ jours avec $m$ très très grand).<br/>

<br/><b>Partie 1</b> <br/>

Un représentant lui propose une nouvelle machine (que l'on appellera <b>machine 1</b>) produisant des pièces du même type. Le chef d'entreprise souhaite l'acheter à condition qu'il soit assuré que cette machine 1 est d'une part plus performante (c'est à dire, de moyenne théorique une fois et demi plus grande que son ancienne machine de référence) et d'autre part plus régulière (c'est à dire, d'écart-type théorique deux fois plus petit que l'ancienne). Soient $\mu^{M1}$ et $\sigma_{M1}$, les caractéristiques de la machine 1 correspondant respectivement à la moyenne et à l'écart-type des productions quotidiennes obtenues <b>si on pouvait faire tourner la machine 1 pendant une infinité de jours</b>.<br/>

<br/>(1) Exprimer à partir de $\mu^{M1}$ et $\sigma^2_{M1}$ (ou $\sigma_{M1}$) les deux conditions d'achat de la nouvelle machine exprimées par le chef d'entreprise.<br/>

<button id="ok_H1_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_H1">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>
Le chef d'entreprise décidera d'acheter la nouvelle machine si $\mu^{M1}>1.5\times 1214=1821$ et si $\sigma_{M1}^2 < (35.4/2)^2=313.29$.
</div></div></div>



Pour espérer connaître les ordres de grandeur de ces quantités inconnues, le chef d'entreprise demande au représentant une période d'essai de 100 jours. Le vecteur ${\mathbf{  y^{M1}  }}=(y_1^{M1},y_2^{M1},\ldots,y_{100}^{M1})$ représente les nombres de pièces fabriquées pour chaque jour de cette période d'essai. Ce vecteur de données a été préalablement saisi dans le logiciel R sous le nom $\mathtt{yM1}$. <br/>

<br/>(2) Peut-on conseiller au chef d'entreprise d'acheter la machine 1 (lorsqu'on sait qu'il accepte que tout test statistique est <i>généralement</i> traité à un seuil de signification $\alpha=5\%$) ? <br/>

<pre class="solarized">
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Variable">yM1</span>
  [<span class="Number">1</span>] <span class="Number">1844</span> <span class="Number">1828</span> <span class="Number">1837</span> <span class="Number">1833</span> <span class="Number">1831</span> <span class="Number">1818</span> <span class="Number">1836</span> <span class="Number">1837</span> <span class="Number">1840</span> <span class="Number">1820</span> <span class="Number">1845</span> <span class="Number">1815</span> <span class="Number">1831</span> <span class="Number">1839</span> <span class="Number">1824</span>
 [<span class="Number">16</span>] <span class="Number">1839</span> <span class="Number">1836</span> <span class="Number">1840</span> <span class="Number">1822</span> <span class="Number">1824</span> <span class="Number">1820</span> <span class="Number">1839</span> <span class="Number">1849</span> <span class="Number">1846</span> <span class="Number">1817</span> <span class="Number">1822</span> <span class="Number">1832</span> <span class="Number">1846</span> <span class="Number">1832</span> <span class="Number">1834</span>
<span class="Keyword">...</span>
 [<span class="Number">76</span>] <span class="Number">1810</span> <span class="Number">1838</span> <span class="Number">1844</span> <span class="Number">1830</span> <span class="Number">1830</span> <span class="Number">1829</span> <span class="Number">1807</span> <span class="Number">1797</span> <span class="Number">1814</span> <span class="Number">1807</span> <span class="Number">1844</span> <span class="Number">1834</span> <span class="Number">1827</span> <span class="Number">1841</span> <span class="Number">1830</span>
 [<span class="Number">91</span>] <span class="Number">1830</span> <span class="Number">1834</span> <span class="Number">1840</span> <span class="Number">1832</span> <span class="Number">1844</span> <span class="Number">1815</span> <span class="Number">1825</span> <span class="Number">1821</span> <span class="Number">1840</span> <span class="Number">1821</span>

</pre>
<br/><i>Performance</i><br/>
<pre class="solarized">
<span class="Variable">R</span><span class="Keyword">&gt;</span> mean(<span class="Variable">yM1</span>)
[<span class="Number">1</span>] <span class="Number">1830.13</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Comment"><span class="Comment">#</span> deltaEst.H0 &lt;- (instruction R à fournir dans la rédaction)</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Variable">deltaEst.H0</span>
[<span class="Number">1</span>] <span class="Number">8.197877</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> pnorm(<span class="Variable">deltaEst.H0</span>)
[<span class="Number">1</span>] <span class="Number">1</span>

</pre>
<br/><i>Régularité</i><br/>
<pre class="solarized">
<span class="Variable">R</span><span class="Keyword">&gt;</span> var(<span class="Variable">yM1</span>)
[<span class="Number">1</span>] <span class="Number">124.0334</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Comment"><span class="Comment">#</span> deltaEst.H0 &lt;- (instruction R à fournir dans la rédaction)</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Variable">deltaEst.H0</span>
[<span class="Number">1</span>] <span class="Keyword">-</span><span class="Number">11.41626</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> pnorm(<span class="Variable">deltaEst.H0</span>)
[<span class="Number">1</span>] <span class="Number">1.734226e-30</span>

</pre>
 
<button id="ok_mu1var1_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_mu1var1">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>
<br/><i>A propos de la performance</i> :<br/>

<br/><b>Hypothèses de test</b> : \(\mathbf{H}_0:\) \(\mu^{M1}=1214*1.5\) vs \(\mathbf{H}_1:\) \(\mu^{M1}>1214*1.5\)
<br/><b>Statistique de test sous \(\mathbf{H}_0\)</b> :
  \[
   \widehat{  \delta_{\mu^{M1},1214*1.5} }\left({\mathbf{ { Y^{M1} } }}\right) = {\displaystyle \frac{\widehat{  \mu^{M1} }\left({\mathbf{ { Y^{M1} } }}\right)-1214*1.5}{
\widehat{  \sigma_{\widehat{ \mu^{M1}}} }\left({\mathbf{ { Y^{M1} } }}\right)
}} \underset{Approx.}{\leadsto} \mathcal{N}(0,1)
  \]

<br/><b>Règle de décision</b> : Accepter \(\mathbf{H}_1\) si
  p-valeur (droite) < \(5\%\)
<br/><b>Conclusion</b> :
puisqu'au vu des données,
  $$
p-valeur\overset{\mathtt{R}}{=}\mathtt{1-pnorm((mean(yM1)-1214*1.5)/seMean(yM1))} \simeq 0.0\% < 5\%,
$$
on peut (plutôt) penser (avec un risque de \(5\%\)) que la machine 1 est plus performante que son ancienne machine.
<br/> <i>A propos de la régularité</i> :<br/>

<br/><b>Hypothèses de test</b> : \(\mathbf{H}_0:\) \(\sigma^2_{M1}=(35.4/2)^2\) vs \(\mathbf{H}_1:\) \(\sigma^2_{M1}<(35.4/2)^2\)
<br/><b>Statistique de test sous \(\mathbf{H}_0\)</b> :
  \[
   \widehat{  \delta_{\sigma^2_{M1},(35.4/2)^2} }\left({\mathbf{ { Y^{M1} } }}\right) = {\displaystyle \frac{\widehat{  \sigma^2_{M1} }\left({\mathbf{ { Y^{M1} } }}\right)-(35.4/2)^2}{
\widehat{  \sigma_{\widehat{ \sigma^2_{M1}}} }\left({\mathbf{ { Y^{M1} } }}\right)
}} \underset{Approx.}{\leadsto} \mathcal{N}(0,1)
  \]

<br/><b>Règle de décision</b> : Accepter \(\mathbf{H}_1\) si
  p-valeur (gauche) < \(5\%\)
<br/><b>Conclusion</b> :
puisqu'au vu des données,
  $$
p-valeur\overset{\mathtt{R}}{=}\mathtt{pnorm((var(yM1)-(35.4/2)^2)/seVar(yM1))} \simeq 0.0\% < 5\%,
$$
on peut (plutôt) penser (avec un risque de \(5\%\)) que la machine 1 est plus régulière que son ancienne machine.
Finalement, on peut conseiller au chef d'entreprise d'acheter la machine 1.
</div></div></div>



<br/><b>Partie 2</b><br/> Le chef d'entreprise prêt à acheter la machine 1 reçoit la visite d'un second représentant vantant les mérites de sa machine (que l'on appellera bien évidemment <b>machine 2</b>) par rapport à toutes les autres existant sur le marché. Les machines 1 et 2 étant de prix équivalents, le chef d'entreprise convaincu par l'éloquence du représentant décide de tester cette seconde machine sur une période de $n^{M2}=50$ ($<n^{M1}=100$ de par les réalités du calendrier que doit tenir le chef d'entreprise) jours afin de la comparer à la machine 1. <br/>
Définissons par $\mu^{M2}$ et $\sigma_{M2}$, les caractéristiques de la machine 2. On stockera les productions quotidiennes sur 50 jours dans le vecteur $y^{M2}$, préalablement saisi en $\mathtt{R}$ sous le nom $\mathtt{yM2}$ :
<pre class="solarized">
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Variable">yM2</span>
 [<span class="Number">1</span>] <span class="Number">2025</span> <span class="Number">2045</span> <span class="Number">2017</span> <span class="Number">2024</span> <span class="Number">2016</span> <span class="Number">2025</span> <span class="Number">2023</span> <span class="Number">2020</span> <span class="Number">2008</span> <span class="Number">2025</span> <span class="Number">2017</span> <span class="Number">2014</span> <span class="Number">2024</span> <span class="Number">2028</span> <span class="Number">2009</span>
[<span class="Number">16</span>] <span class="Number">2023</span> <span class="Number">2024</span> <span class="Number">2034</span> <span class="Number">2023</span> <span class="Number">2024</span> <span class="Number">2029</span> <span class="Number">2032</span> <span class="Number">2013</span> <span class="Number">2017</span> <span class="Number">2019</span> <span class="Number">2022</span> <span class="Number">2023</span> <span class="Number">2005</span> <span class="Number">2031</span> <span class="Number">2012</span>
<span class="Keyword">...</span>
[<span class="Number">31</span>] <span class="Number">2014</span> <span class="Number">2032</span> <span class="Number">2018</span> <span class="Number">2022</span> <span class="Number">2035</span> <span class="Number">2024</span> <span class="Number">2034</span> <span class="Number">2012</span> <span class="Number">2017</span> <span class="Number">2015</span> <span class="Number">2020</span> <span class="Number">2015</span> <span class="Number">2018</span> <span class="Number">2020</span> <span class="Number">2033</span>
[<span class="Number">46</span>] <span class="Number">2025</span> <span class="Number">2026</span> <span class="Number">2026</span> <span class="Number">2023</span> <span class="Number">2014</span>

</pre>

<br/>(1) Peut-on montrer que les productions moyennes des deux machines sont différentes ?<br/>

<button id="ok_dmu_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_dmu">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>
<br/><i>A propos de la performance</i> :<br/>
<br/><b>Préliminaire</b> : puisque \(\mathtt{(mean(yM1)-mean(yM2)-0)}\simeq-191.75\) est du même signe (i.e. positif) que \(\mathtt{deltaEst.H0}\) (car p-valeur gauche inférieure à \(50\%\)), on a :
      <ul>
<li> <i>paramètre d'intérêt</i> : \(d_\mu=\mu^{M1}-\mu^{M2}\)
<li> <i>sa future estimation</i> : \(\widehat{  d_\mu }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)=\widehat{  \mu^{M1} }\left({\mathbf{ { Y^{M1} } }}\right)-\widehat{  \mu^{M2} }\left({\mathbf{ { Y^{M2} } }}\right)\)
</ul>
<br/><b>Hypothèses de test</b> : \(\mathbf{H}_0:\) \(d_\mu=0\) vs \(\mathbf{H}_1:\) \(d_\mu\neq0\)
<br/><b>Statistique de test sous \(\mathbf{H}_0\)</b> :
  \[
   \widehat{  \delta_{d_\mu,0} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right) = {\displaystyle \frac{\widehat{  d_\mu }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)-0}{
\widehat{  \sigma_{\widehat{ d_\mu}} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)
}} \underset{Approx.}{\leadsto} \mathcal{N}(0,1)
  \]

<br/><b>Règle de décision</b> : Accepter \(\mathbf{H}_1\) si
  p-valeur (biltatérale) < \(5\%\)
<br/><b>Conclusion</b> :
puisqu'au vu des données,
  $$
p-valeur\overset{\mathtt{R}}{=}\mathtt{2*pnorm((mean(yM1)-mean(yM2)-0)/seDMean(yM1,yM2))} \simeq 0.0\% < 5\%,
$$
on peut (plutôt) penser (avec un risque de \(5\%\)) que les productions moyennes des deux machines sont différentes.
</div></div></div>


  

<br/>(2) Peut-on montrer que la seconde machine produit plus (en moyenne) et plus régulièrement que la machine 1 ?

<br/><i>Performance</i><br/>
<pre class="solarized">
<span class="Variable">R</span><span class="Keyword">&gt;</span> mean(<span class="Variable">yM2</span>)
[<span class="Number">1</span>] <span class="Number">2021.88</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> mean(<span class="Variable">yM1</span>)<span class="Keyword">-</span>mean(<span class="Variable">yM2</span>)
[<span class="Number">1</span>] <span class="Keyword">-</span><span class="Number">191.75</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Comment"><span class="Comment">#</span> deltaEst.H0 &lt;- (instruction R à fournir dans la rédaction)</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Variable">deltaEst.H0</span>
[<span class="Number">1</span>] <span class="Keyword">-</span><span class="Number">122.3457</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> pnorm(<span class="Variable">deltaEst.H0</span>)
[<span class="Number">1</span>] <span class="Number">0</span>

</pre>
<br/><i>Régularité</i><br/>
<pre class="solarized">
<span class="Variable">R</span><span class="Keyword">&gt;</span> var(<span class="Variable">yM2</span>)
[<span class="Number">1</span>] <span class="Number">60.80163</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> var(<span class="Variable">yM1</span>)<span class="Keyword">-</span>var(<span class="Variable">yM2</span>)
[<span class="Number">1</span>] <span class="Number">63.2318</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Comment"><span class="Comment">#</span> deltaEst.H0 &lt;- (instruction R à fournir dans la rédaction)</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Variable">deltaEst.H0</span>
[<span class="Number">1</span>] <span class="Number">2.992739</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> pnorm(<span class="Variable">deltaEst.H0</span>)
[<span class="Number">1</span>] <span class="Number">0.9986176</span>

</pre>

<button id="ok_dmudvar_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_dmudvar">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>
<br/><i>A propos de la performance</i> :<br/>
<br/><b>Préliminaire</b> : puisque \(\mathtt{(mean(yM1)-mean(yM2)-0)}\simeq-191.75\) est du même signe (i.e. positif) que \(\mathtt{deltaEst.H0}\) (car p-valeur gauche inférieure à \(50\%\)), on a :
      <ul>
<li> <i>paramètre d'intérêt</i> : \(d_\mu=\mu^{M1}-\mu^{M2}\)
<li> <i>sa future estimation</i> : \(\widehat{  d_\mu }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)=\widehat{  \mu^{M1} }\left({\mathbf{ { Y^{M1} } }}\right)-\widehat{  \mu^{M2} }\left({\mathbf{ { Y^{M2} } }}\right)\)
</ul>
<br/><b>Hypothèses de test</b> : \(\mathbf{H}_0:\) \(d_\mu=0\) vs \(\mathbf{H}_1:\) \(d_\mu<0\)
<br/><b>Statistique de test sous \(\mathbf{H}_0\)</b> :
  \[
   \widehat{  \delta_{d_\mu,0} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right) = {\displaystyle \frac{\widehat{  d_\mu }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)-0}{
\widehat{  \sigma_{\widehat{ d_\mu}} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)
}} \underset{Approx.}{\leadsto} \mathcal{N}(0,1)
  \]

<br/><b>Règle de décision</b> : Accepter \(\mathbf{H}_1\) si
  p-valeur (gauche) < \(5\%\)
<br/><b>Conclusion</b> :
puisqu'au vu des données,
  $$
p-valeur\overset{\mathtt{R}}{=}\mathtt{pnorm((mean(yM1)-mean(yM2)-0)/seDMean(yM1,yM2))} \simeq 0.0\% < 5\%,
$$
on peut (plutôt) penser (avec un risque de \(5\%\)) que les productions moyennes des deux machines sont différentes.
<br/><i>A propos de la régularité</i> :<br/>
<br/><b>Préliminaire</b> : puisque \(\mathtt{(var(yM1)-var(yM2)-0)}\simeq63.2318\) est du même signe (i.e. positif) que \(\mathtt{deltaEst.H0}\) (car p-valeur gauche inférieure à \(50\%\)), on a :
      <ul>
<li> <i>paramètre d'intérêt</i> : \(d_{\sigma^2}=\sigma^2_{M1}-\sigma^2_{M2}\)
<li> <i>sa future estimation</i> : \(\widehat{  d_{\sigma^2} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)=\widehat{  \sigma^2_{M1} }\left({\mathbf{ { Y^{M1} } }}\right)-\widehat{  \sigma^2_{M2} }\left({\mathbf{ { Y^{M2} } }}\right)\)
</ul>
<br/><b>Hypothèses de test</b> : \(\mathbf{H}_0:\) \(d_{\sigma^2}=0\) vs \(\mathbf{H}_1:\) \(d_{\sigma^2}>0\)
<br/><b>Statistique de test sous \(\mathbf{H}_0\)</b> :
  \[
   \widehat{  \delta_{d_{\sigma^2},0} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right) = {\displaystyle \frac{\widehat{  d_{\sigma^2} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)-0}{
\widehat{  \sigma_{\widehat{ d_{\sigma^2}}} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)
}} \underset{Approx.}{\leadsto} \mathcal{N}(0,1)
  \]

<br/><b>Règle de décision</b> : Accepter \(\mathbf{H}_1\) si
  p-valeur (droite) < \(5\%\)
<br/><b>Conclusion</b> :
puisqu'au vu des données,
  $$
p-valeur\overset{\mathtt{R}}{=}\mathtt{1-pnorm((var(yM1)-var(yM2)-0)/seDVar(yM1,yM2))} \simeq 0.14\% < 5\%,
$$
on peut (plutôt) penser (avec un risque de \(5\%\)) que la seconde machine produit plus régulièrement que la première.
</div></div></div>


 
<br/>(3) Peut-on montrer que la seconde machine produit 190 pièces de plus par jour (en moyenne) que la première ?  <br/>

<br/>(4) La seconde machine est-elle 1.5 fois plus régulière (i.e. de variance 1.5 fois plus petite) que la première ? <br/>


<pre class="solarized">
<span class="Variable">R</span><span class="Keyword">&gt;</span> (mean(<span class="Variable">yM1</span>)<span class="Keyword">-</span>mean(<span class="Variable">yM2</span>)<span class="Keyword">+</span><span class="Number">190</span>)<span class="Keyword">/</span>seDMean(<span class="Variable">yM1</span>,<span class="Variable">yM2</span>)
[<span class="Number">1</span>] <span class="Keyword">-</span><span class="Number">1.116584</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> pnorm( (mean(<span class="Variable">yM1</span>)<span class="Keyword">-</span>mean(<span class="Variable">yM2</span>)<span class="Keyword">+</span><span class="Number">190</span>)<span class="Keyword">/</span>seDMean(<span class="Variable">yM1</span>,<span class="Variable">yM2</span>) )
[<span class="Number">1</span>] <span class="Number">0.1320861</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> (var(<span class="Variable">yM1</span>)<span class="Keyword">/</span>var(<span class="Variable">yM2</span>)<span class="Keyword">-</span><span class="Number">1.5</span>)<span class="Keyword">/</span>seRVar(<span class="Variable">yM1</span>,<span class="Variable">yM2</span>)
[<span class="Number">1</span>] <span class="Number">1.044032</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> pnorm((var(<span class="Variable">yM1</span>)<span class="Keyword">/</span>var(<span class="Variable">yM2</span>)<span class="Keyword">-</span><span class="Number">1.5</span>)<span class="Keyword">/</span>seRVar(<span class="Variable">yM1</span>,<span class="Variable">yM2</span>))
[<span class="Number">1</span>] <span class="Number">0.8517646</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> pnorm((var(<span class="Variable">yM2</span>)<span class="Keyword">/</span>var(<span class="Variable">yM1</span>)<span class="Keyword">-</span><span class="Number">1</span><span class="Keyword">/</span><span class="Number">1.5</span>)<span class="Keyword">/</span>seRVar(<span class="Variable">yM2</span>,<span class="Variable">yM1</span>))
[<span class="Number">1</span>] <span class="Number">0.07782401</span>

</pre>

<button id="ok_dmudvar2_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_dmudvar2">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>
<br/><i>A propos de la performance</i> :<br/>
<br/><b>Préliminaire</b> : puisque \(\mathtt{(mean(yM1)-mean(yM2)--190)}\simeq-1.75\) est du même signe (i.e. positif) que \(\mathtt{deltaEst.H0}\) (car p-valeur gauche inférieure à \(50\%\)), on a :
      <ul>
<li> <i>paramètre d'intérêt</i> : \(d_\mu=\mu^{M1}-\mu^{M2}\)
<li> <i>sa future estimation</i> : \(\widehat{  d_\mu }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)=\widehat{  \mu^{M1} }\left({\mathbf{ { Y^{M1} } }}\right)-\widehat{  \mu^{M2} }\left({\mathbf{ { Y^{M2} } }}\right)\)
</ul>
<br/><b>Hypothèses de test</b> : \(\mathbf{H}_0:\) \(d_\mu=-190\) vs \(\mathbf{H}_1:\) \(d_\mu<-190\)
<br/><b>Statistique de test sous \(\mathbf{H}_0\)</b> :
  \[
   \widehat{  \delta_{d_\mu,-190} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right) = {\displaystyle \frac{\widehat{  d_\mu }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)-(-190)}{
\widehat{  \sigma_{\widehat{ d_\mu}} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)
}} \underset{Approx.}{\leadsto} \mathcal{N}(0,1)
  \]

<br/><b>Règle de décision</b> : Accepter \(\mathbf{H}_1\) si
  p-valeur (gauche) < \(5\%\)
<br/><b>Conclusion</b> :
puisqu'au vu des données,
  $$
p-valeur\overset{\mathtt{R}}{=}\mathtt{pnorm((mean(yM1)-mean(yM2)-(-190))/seDMean(yM1,yM2))} \simeq 13.21\%\nless5\%,
$$
on NE peut PAS (plutôt) penser (avec un risque de \(5\%\)) que les productions moyennes des deux machines sont différentes.

<br/><i>A propos de la régularité</i> :<br/> une des deux possibilités suivantes est admise.<br/>
<ul>
<li><i>Cas où paramètre d'intérêt est :</i> $r_{\sigma^2}=\displaystyle \frac{\sigma^2_{M1}}{\sigma^2_{M2}}$</li>
<br/><b>Préliminaire</b> : puisque \(\mathtt{(var(yM1)/var(yM2)-1.5)}\simeq0.5399688\) est du même signe (i.e. positif) que \(\mathtt{deltaEst.H0}\) (car p-valeur gauche inférieure à \(50\%\)), on a :
      <ul>
<li> <i>paramètre d'intérêt</i> : \(r_{\sigma^2}=\displaystyle \frac{\sigma^2_{M1}}{\sigma^2_{M2}}\)
<li> <i>sa future estimation</i> : \(\widehat{  r_{\sigma^2} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)=\widehat{  \sigma^2_{M1} }\left({\mathbf{ { Y^{M1} } }}\right)/\widehat{  \sigma^2_{M2} }\left({\mathbf{ { Y^{M2} } }}\right)\)
</ul>
<br/><b>Hypothèses de test</b> : \(\mathbf{H}_0:\) \(r_{\sigma^2}=1.5\) vs \(\mathbf{H}_1:\) \(r_{\sigma^2}>1.5\)
<br/><b>Statistique de test sous \(\mathbf{H}_0\)</b> :
  \[
   \widehat{  \delta_{r_{\sigma^2},1.5} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right) = {\displaystyle \frac{\widehat{  r_{\sigma^2} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)-1.5}{
\widehat{  \sigma_{\widehat{ r_{\sigma^2}}} }\left({\mathbf{ { Y^{M1},Y^{M2} } }}\right)
}} \underset{Approx.}{\leadsto} \mathcal{N}(0,1)
  \]

<br/><b>Règle de décision</b> : Accepter \(\mathbf{H}_1\) si
  p-valeur (droite) < \(5\%\)
<br/><b>Conclusion</b> :
puisqu'au vu des données,
  $$
p-valeur\overset{\mathtt{R}}{=}\mathtt{1-pnorm((var(yM1)/var(yM2)-1.5)/seRVar(yM1,yM2))} \simeq 14.82\%\nless5\%,
$$
on NE peut PAS (plutôt) penser (avec un risque de \(5\%\)) que la seconde machine est de variance 1.5 fois plus petite que la première.
<li><i>Cas où paramètre d'intérêt est :</i> $r_{\sigma^2}=\displaystyle \frac{\sigma^2_{M2}}{\sigma^2_{M1}}$</li>
<br/><b>Préliminaire</b> : puisque \(\mathtt{(var(yM2)/var(yM1)-1/1.5)}\simeq-0.1764631\) est du même signe (i.e. positif) que \(\mathtt{deltaEst.H0}\) (car p-valeur gauche inférieure à \(50\%\)), on a :
      <ul>
<li> <i>paramètre d'intérêt</i> : \(r_{\sigma^2}=\displaystyle \frac{\sigma^2_{M2}}{\sigma^2_{M1}}\)
<li> <i>sa future estimation</i> : \(\widehat{  r_{\sigma^2} }\left({\mathbf{ { Y^{M2},Y^{M1} } }}\right)=\widehat{  \sigma^2_{M2} }\left({\mathbf{ { Y^{M2} } }}\right)/\widehat{  \sigma^2_{M1} }\left({\mathbf{ { Y^{M1} } }}\right)\)
</ul>
<br/><b>Hypothèses de test</b> : \(\mathbf{H}_0:\) \(r_{\sigma^2}=1/1.5\) vs \(\mathbf{H}_1:\) \(r_{\sigma^2}<1/1.5\)
<br/><b>Statistique de test sous \(\mathbf{H}_0\)</b> :
  \[
   \widehat{  \delta_{r_{\sigma^2},1/1.5} }\left({\mathbf{ { Y^{M2},Y^{M1} } }}\right) = {\displaystyle \frac{\widehat{  r_{\sigma^2} }\left({\mathbf{ { Y^{M2},Y^{M1} } }}\right)-1/1.5}{
\widehat{  \sigma_{\widehat{ r_{\sigma^2}}} }\left({\mathbf{ { Y^{M2},Y^{M1} } }}\right)
}} \underset{Approx.}{\leadsto} \mathcal{N}(0,1)
  \]

<br/><b>Règle de décision</b> : Accepter \(\mathbf{H}_1\) si
  p-valeur (gauche) < \(5\%\)
<br/><b>Conclusion</b> :
puisqu'au vu des données,
  $$
p-valeur\overset{\mathtt{R}}{=}\mathtt{pnorm((var(yM2)/var(yM1)-1/1.5)/seRVar(yM2,yM1))} \simeq 7.78\%\nless5\%,
$$
on NE peut PAS (plutôt) penser (avec un risque de \(5\%\)) que la seconde machine est de variance 1.5 fois plus petite que la première.
</ul>
</div></div></div>


</div>

</div>

<script type="text/javascript">
if (typeof clipboardDemo == 'undefined') {
	clipboardDemo = new Clipboard('.clipboard');
	stateClip=false; //global variable
}
stateClip=false; //global variable
$(".clipboard").click(function(e) {stateClip=true;});
$(".demoR").click(function() {
  if(stateClip) {
    stateClip=false;
  } else {
    var state=$( this ).attr("state");
    var link_id=$( this ).attr("link_id");
    if(state=="on") {
      $("#code-"+link_id).hide();
      $("#session-"+link_id).show();
      $( this ).attr("state","off");
    } else {
      $("#code-"+link_id).show();
      $("#session-"+link_id).hide();
      $( this ).attr("state","on");
    }
  }
});
function prev_DemoRFigs(fig) {
  var curfig=demoRFigs[fig]['current'];
  var prevfig=demoRFigs[fig]['prev'][curfig];
  demoRFigs[fig]['figs'].forEach(function(e) {
    if(e == prevfig) {
      $("#img-"+fig+"-"+e).show();$("#code-"+fig+"-"+e).show();
    } else {
      $("#img-"+fig+"-"+e).hide();$("#code-"+fig+"-"+e).hide();
    }
  });
  demoRFigs[fig]['current']=prevfig;
}
function next_DemoRFigs(fig) {
  var curfig=demoRFigs[fig]['current'];
  var nextfig=demoRFigs[fig]['next'][curfig];
  demoRFigs[fig]['figs'].forEach(function(e) {
    if(e == nextfig) {
      $("#img-"+fig+"-"+e).show();$("#code-"+fig+"-"+e).show();
    } else {
      $("#img-"+fig+"-"+e).hide();$("#code-"+fig+"-"+e).hide();
    }
  });
  demoRFigs[fig]['current']=nextfig;
}
//init
$(".demoRSession").hide();
$('.ui.answer.accordion').accordion();
$('.ui.checkbox')
  .checkbox()
;
$('.quizz.checkbox').change(function () {
	var quizz = $(this).attr("quizz");
  update_checkbox_answer($(this));
	update_quizz_score(quizz);
});

function bonjour_quizz_checkbox() {
  var tag; 
  $('.quizz.checkbox').each(function() {
      tag = ($(this).attr("tag") % 2 == 1) ? atob("eWVz") : atob("bm8=");
      $('<input>').attr({
        type: 'hidden',
        class: 'quizz_answer',
        mode: 'checkbox',
        quizz: $(this).attr("quizz"),
        question: $(this).attr("question"),
        id: 'qa-'+$(this).attr("quizz")+'-'+$(this).attr("question")+"-"+$(this).attr("choice"),
        expected: tag,
        answer: '',
        score: 0
      }).insertAfter("#quizz-result-"+$(this).attr("quizz"));
      // if($('#qs-'+$(this).attr("quizz")+'-'+$(this).attr("question") ).length == 0) {
      //   $('<input>').attr({
      //     type: 'hidden',
      //     class: 'quizz_score',
      //     mode: 'checkbox',
      //     quizz: $(this).attr("quizz"),
      //     question: $(this).attr("question"),
      //     id: 'qs-'+$(this).attr("quizz")+'-'+$(this).attr("question"),
      //     score: 0
      //   }).insertAfter("#quizz-result-"+$(this).attr("quizz"));
      // }
  });
}

function update_checkbox_answer(elt) {
  var res, qa=$('#qa-'+elt.attr("quizz")+'-'+elt.attr("question")+"-"+elt.attr("choice"));
  var qa_score=parseInt(qa.attr("score"));
  qa.attr("answer", (elt.prop("checked") ? "yes" : "no" ));
  if(qa.attr("answer") === "no") {
    qa.attr("score",0);
  } else {
    qa.attr("score",qa.attr("expected") == "yes" ? 1 : -1 );
  }
  var qs=$('#qs-'+elt.attr("quizz")+'-'+elt.attr("question"));
  qs.attr("score",parseInt(qs.attr("score"))+parseInt(qa.attr("score"))-qa_score);
}

function update_minir_input_answer(id) {
  var elt=$("#"+id),score;
  var answer=elt.val(),qs=$('#qs-'+elt.attr("quizz")+'-'+elt.attr("question"));
  var id=elt.attr("quizz")+"-"+elt.attr("question");
  qs.attr("answer",answer);
  if(answer == "") {
    score="0";
  } else {
    console.log("ls: "+Opal.eval('QuizzScoreMiniR.ls'));
    var code='QuizzScoreMiniR["'+id+'"].eval("'+answer+'")';
    console.log("code: "+code);
    score=Opal.eval(code);
  }
  console.log("minir score:"+score);
  qs.attr("score",score);
}

function update_minir_textarea_answer(id) {
  var elt=$("#"+id),score;
  var answer=elt.val().split("\n").slice(-1)[0];
  var qs=$('#qs-'+elt.attr("quizz")+'-'+elt.attr("question"));
  var id=elt.attr("quizz")+"-"+elt.attr("question");
  qs.attr("answer",answer);

  console.log("ls: "+Opal.eval('QuizzScoreMiniR.ls'));
  var code='QuizzScoreMiniR["'+id+'"].eval("'+answer+'")';
  console.log("code: "+code);
  score=Opal.eval(code);

  console.log("minir score:"+score);
  qs.attr("score",score);
}

function update_quizz_score_old(quizz) {
  var result="", global=0, count=0, qs, score;
  $( ".quizz_score[quizz='"+quizz+"']").each(function() {
    count += 1;
    switch($(this).attr("mode")) {
    case "checkbox":
    console.log("qs:"+'#qs-'+$(this).attr("quizz")+'-'+$(this).attr("question") );
      qs=$('#qs-'+$(this).attr("quizz")+'-'+$(this).attr("question"));
      score=qs.attr("score");
      result += $(this).attr("question") + ": "+score+ ";";
      global += Math.max(0,score);
    case "minir":
        // QuizzScoreMiniR[""]
        // qs=$('#qs-'+$(this).attr("quizz")+'-'+$(this).attr("question"));
        // score=qs.attr("score");
        // result += $(this).attr("question") + ": "+score+ ";";
        // global += Math.max(0,score);
      break;
    }
  })
  $("#quizz-result-"+quizz).text("Note="+global.toFixed(2)+"/"+count+" ("+result+")");
}

function update_quizz_score(quizz) {
  console.log("update_quizz_score: "+quizz);
  var result="", global=0, count=0, qs, score,mode,smax;
  var questions=jQuery.unique($('.quizz[quizz="'+quizz+'"]').map(function() {return $(this).attr("question")})).toArray();
  console.log("question_s: "+questions);
  questions.forEach(function(question) {
    count += 1;
    mode=$('.quizz[quizz="'+quizz+'"][question="'+question+'"]').attr('mode');
    switch(mode) {
    case "checkbox":
      qs=$('#qs-'+quizz+'-'+question);
      score=qs.attr("score");smax=qs.attr("max");
      result += question + ": " + score + (smax=="1" ?  "" : ("/" + smax)) + ";";
      global += Math.max(0,score/smax);
      break;
    case "minir-input":
        qs=$('#qs-'+quizz+'-'+question);
        score=qs.attr("score");
        result += question + ": "+score+ ";";
        var id=quizz+'-'+question;
        //console.log(Opal.eval('QuizzScoreMiniR.ls'));
        //console.log('id='+id);
        var nb=Opal.eval('QuizzScoreMiniR["'+id+'"].nb_rules');
        //console.log("nb="+nb);
        global += Math.max(0,eval(score)/nb);
      break;
    case "minir-textarea":
        qs=$('#qs-'+quizz+'-'+question);
        score=qs.attr("score");
        result += question + ": "+score+ ";";
        var id=quizz+'-'+question;
        //console.log(Opal.eval('QuizzScoreMiniR.ls'));
        //console.log('id='+id);
        var nb=Opal.eval('QuizzScoreMiniR["'+id+'"].nb_rules');
        //console.log("nb="+nb);
        global += Math.max(0,eval(score)/nb);
      break;
    }
  });
  $("#quizz-result-"+quizz).text("Note="+global.toFixed(2)+"/"+count+" ("+result+")");
}

// function bonjour_quizz_miniR() {
//     var e=$("#quizz-result-"+$(this).attr("quizz"));
//     $('.quizz.minir').each(function() {
//        $('<input>').attr({
//         type: 'hidden',
//         class: 'quizz answer',
//         mode: 'minir',
//         quizz: $(this).attr("quizz"),
//         question: $(this).attr("question"),
//         id: 'qa-'+$(this).attr("quizz")+'-'+$(this).attr("question"),
//         answer: '',
//         score: 0
//        }).insertAfter(e)
//  });
// }

bonjour_quizz_checkbox();
//bonjour_quizz_miniR();
Cqls={Quizz: {}};
Cqls.code="";

function setCqlsCode(code) {
	Cqls.code=code;
}
function getExoData(exo) {
  var code;
  switch (exo) {
  case "alfredN20":
    code="yA=c(0.144679564279082, 0.308391019822987, 0.165071844320451, 0.0810088511346089,-0.150489835962709, -0.0216344580330839, -0.255587942544298,0.0987153563164697, 0.592751352277294, -0.229624997435348, -0.216767323099697,-0.0970720818772463, 0.170505292061653, -0.0573236584450232,0.653375135601917, 0.178024688692504, 0.292787345192972, -0.165149721585414,-0.300802214354508, 0.32129751773001)";
    break;
  case "alfred":
    code="yA=c(0.144679564279082, 0.308391019822987, 0.165071844320451, 0.0810088511346089,-0.150489835962709, -0.0216344580330839, -0.255587942544298,0.0987153563164697, 0.592751352277294, -0.229624997435348, -0.216767323099697,-0.0970720818772463, 0.170505292061653, -0.0573236584450232,0.653375135601917, 0.178024688692504, 0.292787345192972, -0.165149721585414,-0.300802214354508, 0.32129751773001, 0.0805886239932639, 0.143171545682753,-0.00298066490980145, -0.255637645785468, 0.0928007482527018,-0.153861013155069, -0.091326084306205, 0.296172089667303, 0.00686887343119331,-0.596877687513186, -0.0584200940407693, 0.0720811015026169,0.0175687232410191, 0.153389781110694, -0.44979678290783, 0.213281328016978,-0.0386525306111942, -0.081768580854734, -0.165385713923966,-0.454948636494848, 0.262084533688519, -0.215753300244686, 0.173626814513985,-0.20016068068908, -0.255138748345693, 0.125329351017599, -0.326049545254994,0.207517749735126, 0.0704389198591811, -0.303221493327114)";
    break;
  case "dictee":
    code="yD=c(9, 10, 0, 1, 0, 5, 6, 10, 8, 1, 13, 9, 8, 3, 0, 0, 1, 0, 0, 0, 6, 9, 6, 8, 3, 5, 11, 5, 0, 0)";
    break;
  case "dieteticien":
    code="yD=c(-1, 6, 4, 7, 7, 3, 2, 6, 3, 5, 5, 7, 4, 4, 2, 4, 6, 6, 5, 3, 5, 5, 2, 7, 4, 5, 4, 3, 6, 7, 4, 6, 4, 5, 2, 6, 4, 6, 5, 5, 6, 4, 3, 2, 3, 6, 5, 7, 2, 4);AV=c(64,67,68,76,72,69,62,65,64,73);AP=c(65,61,64,69,65,66,60,59,61,68)";
    break;

  case "produitA":
      code="yA=c(0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,0,1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,1,1,0,1,0,0,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1,0,1,0,1,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,1,0,0,0,0,1,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,1,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1,0,0,1,1,1,0,0,1,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,1,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,0,1,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,1,0,1,0,0,1,1,0,1,0,0,0,0,1,0,0,0,0,1,1,0,0,0,1,0,0,0,1,1,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,1,0,0,0,1,1,0,1,1,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,1,1,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,1,0,1,0,0,0,0);"
      break;

    case "produitB":
      code="yB=c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,1,0,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,0,2,0,0,2,0,0,0,2,0,2,2,2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,3,0,0,0,0,0,3,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,0,0,0,3,0,1,0,2,0,0,0,0,2,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,3,0,0,1,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,0,1,0,2,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,3,0,0,0,0,0,1,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);"
      break;

    case "primeProdA":
      code="yQ=c(9,4,3,7,6,8,2,7,3,9,9,4,8,9,4,8,10,4,9,5,2,7,2,3,2,4,9,6,10,8,5,5,5,5,10,7,4,4,4,4,6,8,2,8,9,5,7,8,6,4,8,6,6,5,3,7,4,5,2,4,6,8,3,9,5,5,9,5,10,5,4,4,4,2,6,8,2,5,10,8,6,9,8,5,7,10,6,8,7,7,7,3,7,8,6,9,6,6,8,7,8,7,8,10,6,8,5,9,4,10,7,9,4,7,4,7,10,4,2,5,7,3,5,8,7,9,6,3,6,2,10,9,10,10,10,4,6,7,9,10,3,10,3,2,9,5,6,9,8,9,7,10,6,5,4,9,5,6,4,2,6,7,5,6,10,8,6,5,9,7,2,2,2,8,9,6,3,8,7,6,3,8,10,2,2,8,9,10,9,8,2,7,7,10,3,3,2,9,7,6);"
      break;

    case "competence":
      code="yC=c(0.3452062,0.3618771,0.2832608,-0.04273267,0.07897429,-0.5758346,-0.7199432,0.181882,0.04438047,-0.01951828,-0.3482005,0.2606782,-0.211132,-0.288865,-0.1782186,0.08062292,0.5697587,0.2163659,-0.05521338,-0.4348432,-0.08501561,0.05719431,-0.1577344,0.08525453,0.3121257,0.1269254,-0.178035,-0.1786163,-0.4814323,-0.07185419);"
      break;

    case "pilote1N20":
      code="y1=c(47.89674,50.04087,54.5324,54.36718,48.80645,51.44077,49.72669,44.81843,50.3791,48.32037,53.5515,50.38611,50.37899,49.44585,50.47262,50.66881,50.44251,50.10745,47.43873,51.17308);"
      break;

    case "pilote1":
      code="y1=c(47.89674,50.04087,54.5324,54.36718,48.80645,51.44077,49.72669,44.81843,50.3791,48.32037,53.5515,50.38611,50.37899,49.44585,50.47262,50.66881,50.44251,50.10745,47.43873,51.17308,51.1604,50.06874,48.85899,52.08231,49.59702,52.87073,50.63278,50.04054,53.13216,50.13489,53.72466,50.48863,48.83423,51.93978,49.19886,52.67034,49.2136,48.35678,49.43116,48.95199);"
      break;

    case "pilote2":
      code="y2=c(51.89371,51.35814,52.16305,51.83228,52.97653,51.43513,50.8937,51.50756,51.54468,52.22917,51.21122,52.96252,51.61797,52.40225,50.21097,51.73468,52.1436,52.57952,51.60721,52.15696,51.51422,53.23509,53.55053,52.62854,51.3968,52.51582,51.7682,53.42508,52.59148,51.55015,53.02435,52.20928,52.13902,52.04843,53.60312,50.48255,51.36794,52.73886,50.4655,51.92149,50.82357,53.11825,52.30076,49.99984,52.47019,51.9189,52.68014,51.25526,53.55974,52.44708);"
      break;

    case "bernardN20":
      code="yB=c(0.02483016,0.09379133,0.145188,-0.04969999,-0.1532143,0.1208757,-0.112933,-0.3452917,-0.007106278,0.1220161,-0.1919765,-0.3684244,0.1882093,-0.1190619,-0.2020528,0.2495189,-0.3013964,0.1123033,0.2164801,0.2393351);"
      break;

    case "bernard":
      code="yB=c(0.02483016,0.09379133,0.145188,-0.04969999,-0.1532143,0.1208757,-0.112933,-0.3452917,-0.007106278,0.1220161,-0.1919765,-0.3684244,0.1882093,-0.1190619,-0.2020528,0.2495189,-0.3013964,0.1123033,0.2164801,0.2393351,0.1428402,-0.323352,0.04930722,-0.02417904,0.1530558,0.1237836,-0.006933568,-0.06470596,0.1438609,0.02115967,-0.1333253,0.3044679,0.04528947,0.06454683,0.03938363,0.4622106,-0.1950227,-0.009857142,0.08429325,-0.04374064,-0.278324,0.3768047,-0.1410857,-0.01711132,0.04389444,0.07555481,0.2506217,0.3180829,0.005132367,0.0152481,0.2962752,-0.1621414,0.06079287,0.09097692,0.1198565,0.310566,-0.1467855,0.06196827,-0.1821278,-0.1878903);"
      break;

    case "conduite":
      code="yH=c(24,28,29,29,34,36,40,41,60);yF=c(21,31,34,37,38,39,42,43,44,50,51);"
      break;

    case "adjverbe":
      code="sc=c(1.04,0.93,0.75,0.33,1.62,0.76,0.97,1.21,0.8,1.18);litt=c(1.32,2.3,1.98,0.59,1.02,0.88,0.92,1.39,1.95,1.25);"
      break;

    case "machine":
      code="yM1=c(1844,1828,1837,1833,1831,1818,1836,1837,1840,1820,1845,1815,1831,1839,1824,1839,1836,1840,1822,1824,1820,1839,1849,1846,1817,1822,1832,1846,1832,1834,1847,1828,1809,1833,1830,1824,1834,1842,1837,1818,1812,1825,1839,1840,1817,1827,1827,1842,1846,1839,1822,1816,1834,1810,1826,1836,1834,1839,1832,1827,1847,1842,1844,1831,1840,1823,1828,1822,1804,1821,1823,1846,1836,1823,1831,1810,1838,1844,1830,1830,1829,1807,1797,1814,1807,1844,1834,1827,1841,1830,1830,1834,1840,1832,1844,1815,1825,1821,1840,1821);yM2=c(2025,2045,2017,2024,2016,2025,2023,2020,2008,2025,2017,2014,2024,2028,2009,2023,2024,2034,2023,2024,2029,2032,2013,2017,2019,2022,2023,2005,2031,2012,2014,2032,2018,2022,2035,2024,2034,2012,2017,2015,2020,2015,2018,2020,2033,2025,2026,2026,2023,2014);"
      break;

    case "menu":
      code="yAV=c(8,7,6,7,9,7,6,4,7,5,8,7,6,6,6,6,7,5,7,6,7,7,8,5,4,7,6,5,7,6,8,6,7,7,7,8,5,8,5,5);yAP1=c(9,9,9,6,7,7,9,6,8,6,10,11,6,9,8,8,6,10,7,10,6,8,7,8,9,6,9,9,6,7);yAP2=c(8,10,8,8,9,8,9,5,10,6,10,7,7,6,6,7,11,7,12,6,7,7,10,6,7,7,7,5,8,8,10,6,9,8,8,9,5,10,7,8);"
      break;

    case "notes":
      code="yContC=c(16,16,12,16,11,10,15,19,12,14,17,16,12,10,17,16,12,14,11,16,18,20,13,14,9,10,18,7,6,10,17,18,11,17,14,16,12,12,13,13,12,16,11,15,19,14,16,13,17,18);yExamC=c(14,17,15,13,13,13,12,16,13,15,12,14,13,15,17,15,17,13,13,12,15,14,12,13,9,10,16,11,16,13,13,14,13,15,11,16,14,10,8,15,10,12,12,12,15,10,15,9,13,11);yExamD=c(13,13,11,10,13,11,12,11,9,13,10,11,12,14,11,11,10,17,10,7,17,11,9,10,14,11,9,11,10,10,12,11,12,12,10,9,12,12,10,11,8,5,14,9,12,11,11,9,11,11);"
      break;

    case "chAffN20":
      code="yP1=c(98.83,96.56,86.08,84.08,93.68,106.74,93.42,104.04,99.24,87.47,117.65,115.26,109.33,92.71,105.48,93.09,106.59,82.92,96.31,87.99);yP2=c(63.89,72.36,88.48,74.28,71.63,82.45,67.42,76.01,74.33,77.81,71.67,72.38,80.33,77.67,67.29,73.98,65.97,76.65,74.02,88.96);"
      break;

    case "chAff":
      code="yP1=c(98.83,96.56,86.08,84.08,93.68,106.74,93.42,104.04,99.24,87.47,117.65,115.26,109.33,92.71,105.48,93.09,106.59,82.92,96.31,87.99,99.77,111.22,106.49,100.8,109.97,96.91,83.39,101.57,100.1,110.07,94.03,114.85,105.3,106.5,88.68,100.94,98.4,101.98,112.11,79.68);yP2=c(63.89,72.36,88.48,74.28,71.63,82.45,67.42,76.01,74.33,77.81,71.67,72.38,80.33,77.67,67.29,73.98,65.97,76.65,74.02,88.96,71.19,81.9,75.03,80.35,86.16,73.15,73.94,63.95,79.94,59.04,67.5,77.15,74.01,77.45,78.13,74.46,96.59,80,78.19,72.97);"
      break;

    case "chAff0405N20":
      code="y04=c(84.03,95.47,88.89,93.09,87.24,90,86.85,86.61,73.24,73.88,97.2,96.47,85.61,64.47,67.98,78.2,86.76,81.73,74.35,83.55);y05=c(98.83,96.56,86.08,84.08,93.68,106.74,93.42,104.04,99.24,87.47,117.65,115.26,109.33,92.71,105.48,93.09,106.59,82.92,96.31,87.99);"
      break;

    case "chAff0405":
      code="y04=c(84.03,95.47,88.89,93.09,87.24,90,86.85,86.61,73.24,73.88,97.2,96.47,85.61,64.47,67.98,78.2,86.76,81.73,74.35,83.55,85.15,76.67,87.75,84.52,104.08,72.72,101.8,87.52,86.61,89.96,76.96,95.11,70.88,89.79,87.29,83.36,73.73,79.94,91.97,100.07);y05=c(98.83,96.56,86.08,84.08,93.68,106.74,93.42,104.04,99.24,87.47,117.65,115.26,109.33,92.71,105.48,93.09,106.59,82.92,96.31,87.99,99.77,111.22,106.49,100.8,109.97,96.91,83.39,101.57,100.1,110.07,94.03,114.85,105.3,106.5,88.68,100.94,98.4,101.98,112.11,79.68);"
      break;

    case "tailleEtu":
      code="y1=c(165,179,171,178,171,168,166,171,182,178,177,165,174,164,175,178,167,168,185,166,162,180,167,174,159,159,184,154,172,157)";
      break;
  }
  Cqls.code=code;
  return code;
}

function irb(instrR) {
  return eval(Opal.compile("("+Cqls.code+";"+instrR+").to_Routput",{irb: true}));
}

function preprocessCode(instrR) {
  return instrR.replace(/\<\-/g,"=").replace(/([^\d])(\.\d+)/g,"$1"+"0"+"$2").replace(/\^/g,"**");
}

function evalMiniR(id) {
  var instrR=$("#code-"+id).val()+';'+$("#"+id).val();
  instrR=preprocessCode(instrR);
  var res=irb(instrR);//Opal.eval("("+instrR+")");//eval(Opal.compile(instrR,{irb: true}));
  $("#echo-"+id).html(res);//print(res));
}

function evalMiniRCurrentLine(id) {
  console.log("evalMiniRCurrentLine: "+id);
  var instrsR=$("#"+id).val();
  var debut=instrsR.substr(0,$("#"+id).prop("selectionStart"));
  var line=(debut.split("\n")).length;
  //alert("line="+line);
  var instrR=instrsR.split("\n")[line-1];

  //preliminary code to eval
  irb(preprocessCode($("#code-"+id).val()));
  //textarea current line evaluation
  instrR=preprocessCode(instrR);
  var res=irb(instrR);//Opal.eval("("+instrR+")");//eval(Opal.compile(instrR,{irb: true}));
  $("#echo-"+id).html(res);//print(res));
}

$(".quizz.minir.textarea").keydown(function(e) {
  if((e.metaKey || e.ctrlKey) && ( String.fromCharCode(e.which).toLowerCase() === 'r')) {
    evalMiniR($(this).attr("id"));
    //validAnswer
    update_minir_textarea_answer($(this).attr("id"));
    update_quizz_score($(this).attr("quizz"));

  }
  if((e.metaKey || e.ctrlKey) && ( String.fromCharCode(e.which).toLowerCase() === 'l')) {
    evalMiniRCurrentLine($(this).attr("id"));
  }
  // if( (e.metaKey || e.ctrlKey) && ( String.fromCharCode(e.which).toLowerCase() === 'v') ) {
  //   //validAnswer
  //   update_minir_textarea_answer($(this).attr("id"));
  //   update_quizz_score($(this).attr("quizz"));
  // }

});

$(".quizz.minir.input").keydown(function(e) {
  if(e.which == 13) {
    evalMiniR($(this).attr("id"));
    //validAnswer
    update_minir_input_answer($(this).attr("id"));
    update_quizz_score($(this).attr("quizz"));
  }

});
$("#ok_H1_answer").click(function() {
$(".ok_H1").toggle()
});
$(".ok_H1").hide();
$("#ok_mu1var1_answer").click(function() {
$(".ok_mu1var1").toggle()
});
$(".ok_mu1var1").hide();
$("#ok_dmu_answer").click(function() {
$(".ok_dmu").toggle()
});
$(".ok_dmu").hide();
$("#ok_dmudvar_answer").click(function() {
$(".ok_dmudvar").toggle()
});
$(".ok_dmudvar").hide();
$("#ok_dmudvar2_answer").click(function() {
$(".ok_dmudvar2").toggle()
});
$(".ok_dmudvar2").hide();
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


</body>
</html>
