<!doctype html>
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>td presentation problématiques</title>

<script src="/rsrc/tools/h/jquery-1.11.3/jquery.min.js"></script>



<link href="/rsrc/tools/uv/solarized.css" media="screen,projection,print" rel="Stylesheet" type="text/css" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="/rsrc/tools/css/ascidoctor.css">
<link rel="stylesheet"  href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<script src="/rsrc/tools/clipboard/clipboard.min.js"></script>
<script src="/rsrc/tools/ace-builds/src/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="/rsrc/tools/ace-builds/src/ext-language_tools.js" type="text/javascript" charset="utf-8"></script>
<style type="text/css" media="screen">
.demoR:hover {cursor: zoom-in;}
</style>
<script type="text/javascript">
var demoRFigs={};
</script>

<link rel="stylesheet" type="text/css" href="/rsrc/tools/Semantic-UI-CSS/semantic.min.css"><script src="/rsrc/tools/Semantic-UI-CSS/semantic.min.js"></script>





</head>
<body><div class="ui  container">

<div id="content">




<input type="hidden" id="webr-view-state" val="main"/>
<div id="webr-top-menu" class="ui top menu">
<div class="item">
<button class="ui red button" id="webr-btn-switch" data-tooltip="WebR" data-position="bottom center"><img width="20" width="20" src="/rsrc/users/Web/public/rcqls/img/r-project.svg"></button>
</div>

<div class="webrmenu item"><button id="ok_answer_switcher" class="ui icon mini icon green button" data-tooltip="Active les réponses" data-position="bottom center"><i class="help icon"></i></button></div>

<div class="webrmenu item">
    <div id="question-live-toggle" class="ui orange icon button" ><i class="list icon"></i></div>
    <div id="question-live-popup" class="ui fluid popup">
        <div class="ui container">
        <div class="ui fluid items">
        <div class="item"><div class="ui left labeled input">
            <input type="text" id="question-live-email" placeholder="email">
            <div id="question-live-email-dropdown" class="ui dropdown label">
            <div class="default text">@etu.univ-grenoble-alpes.fr</div>
                <i class="dropdown icon"></i>
                <div class="menu">
                    <div class="item"> </div>
                    <div class="item">@univ-grenoble-alpes.fr</div>
                    <div class="item">@etu.univ-grenoble-alpes.fr</div>
                </div>
            </div>
        </div></div>
        <div class="item"><div class="ui mini action input">
            <input id="question-live-id" type="password" placeholder="Live question id...">
            <input id="question-live-status" type="hidden" value="yellow">
            <button id="question-live-go" class="ui yellow icon button" data-tooltip="Connecter Live Salon" data-position="top center"><i class="play icon"></i></button>
            <button id="question-live-close" class="ui red icon button" data-tooltip="Déconnecter Live Salon" data-position="top right"><i class="delete icon"></i></button>
        </div></div>
        </div>
        </div>
    </div>
</div>
<div class="webrmenu item">
<div id="question-live-message"></div>
</div>

</div>
<div id="webr-main-view">


<div class="ui icon yellow message"><i class="tag
 icon"></i><div class="content"><div class="header">Objectif de la Fiche de TD</div><p>Cette fiche de TD est, comme cela nous serait proposé au restaurant, le <strong>Menu du Cours</strong> :</p>

<ol>
<li>Les deux premiers exercices présentent des problématiques motivant la notion d&#39;<strong>échantillonnage</strong>.</li>
<li>Le troisième exercice est l&#39;unique endroit du cours où est discuté la nature aléatoire d&#39;un échantillon.</li>
<li>Les deux derniers exercices présentent (en survolant les concepts puisque leur développement sera l&#39;objet des cours 2 et 3) l&#39;utilisation des deux seuls outils introduits dans ce cours :

<ul>
<li>estimation par <strong>intervalle de confiance</strong></li>
<li>outil d&#39;aide à la décision via la notion de <strong>p-valeur</strong></li>
</ul></li>
</ol>
</div></div>

<h2> Exercice 1 : Election 2ème tour Max</h2>



<button class="ui mini blue icon button" id="questions-btn-presMax"><i class="calculator icon"></i></button> 
<div class="ui teal message" id="questions-result-presMax-toggle" ><div id="questions-result-presMax"></div></div>


<br/>
 Entre les deux tours d'une élection présidentielle, un candidat, Max, souhaiterait ``rapidement'' avoir un a priori sur la proportion d'intentions de vote en sa faveur. On notera $\pmb{\mathcal{Y}}^{ Max}=\left( \mathcal{Y}_1^{Max},\ldots, \mathcal{Y}_N^{Max}\right)$ l'ensemble des réponses des $N$ électeurs (où $\mathcal{Y}_i^{Max}$ vaut 1 si l'individu $i$ a l'intention de voter pour Max et 0 sinon).

<br/>(1) Déterminez en fonction de $\pmb{\mathcal{Y}}^{ Max}$, le nombre puis la proportion d'intentions de vote en faveur de Max, notée respectivement $N^{Max}$ et $p^{Max}$.


<ul>
<li> <b>Nombre d'intentions de vote en faveur de Max</b><br/>
<div class="ui two column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q1a" name="c1">
<label>$N^{Max} := \displaystyle \frac1N \sum_{i=1}^N \mathcal{Y}_i^{Max}$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q1a" name="c2">
<label>$N^{Max}:= \displaystyle \sum_{i=1}^N \mathcal{Y}_i^{Max}$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q1a" name="c3">
<label>$N^{Max} := N \times \left(\mathcal{Y}_1^{Max} + \mathcal{Y}_2^{Max} + \cdots + \mathcal{Y}_N^{Max}\right)$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q1a" name="c4">
<label>$N^{Max} := \mathcal{Y}_1^{Max} + \mathcal{Y}_2^{Max} + \cdots + \mathcal{Y}_N^{Max}$</label>
</div><!--/div-->
</div>
	</div><!-- fin two columns -->

</li><li> <b>Proportion d'intentions de vote en faveur de Max</b><br/>
<div class="ui two column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q1b" name="c1">
<label>$p^{Max} := \frac{\left(\mathcal{Y}_1^{Max} + \mathcal{Y}_2^{Max} + \cdots + \mathcal{Y}_N^{Max}\right)}N$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q1b" name="c2">
<label>$p^{Max} := \displaystyle \frac1N \sum_{i=1}^N \mathcal{Y}_i^{Max}$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q1b" name="c3">
<label>$p^{Max} := N \times \left(\mathcal{Y}_1^{Max} + \mathcal{Y}_2^{Max} + \cdots + \mathcal{Y}_N^{Max}\right)$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q1b" name="c4">
<label>$p^{Max} := \frac{N^{Max}}N$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q1b" name="c5">
<label>$p^{Max} := \displaystyle \sum_{i=1}^N \mathcal{Y}_i^{Max}$</label>
</div><!--/div-->
</div>
	</div><!-- fin two columns -->

</li>
</ul>


<div class="ok answer">
<button id="ok_max_pop_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_max_pop">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>
<ol>
<li>$N^{Max}:= \displaystyle \sum_{i=1}^N \mathcal{Y}_i^{Max}$</li>
<li>$p^{Max}:= \frac{N^{Max}}N = \displaystyle \frac1N \sum_{i=1}^N \mathcal{Y}_i^{Max}=:\overline{\mathcal{Y^{Max}}}$</li>
</ol>
Puisque la taille de la population est grande, $p^{Max}$ est un paramètre d'intérêt quasiment impossible à évaluer en pratique. Dans ce cours, un paramètre d'intérêt est généralement supposé INCONNU.
</div></div></div>

</div>


<br/>(2) $N$ étant très grand, quelle serait une solution réalisable permettant d'obtenir un remplaçant (i.e. estimation) de $p^{Max}$. Proposez les notations adéquates.

<div class="ui two column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q2" name="c1">
<label>On interroge un nombre $n>N$ que l'on note ${\mathbf{  y^{Max}  }}$ et on calcule $\widehat{  p^{Max} }\left({\mathbf{ { y^{Max} } }}\right) := \displaystyle \frac1n \sum_{i=1}^n y_i^{Max}$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q2" name="c2">
<label>On interroge un nombre $n << N$ que l'on note ${\mathbf{  y^{Max}  }}$ et on calcule $\widehat{  p^{Max} }\left({\mathbf{ { y^{Max} } }}\right) := \displaystyle \frac1n \sum_{i=1}^n y_i^{Max}$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q2" name="c3">
<label>On interroge un nombre $n=10$ personnes que l'on note ${\mathbf{  y^{Max}  }}$ et on calcule $\widehat{  p^{Max} }\left({\mathbf{ { y^{Max} } }}\right) := \displaystyle \frac{1}{10} \sum_{i=1}^{10} y_i^{Max}$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q2" name="c4">
<label>On interroge un nombre $n=N$ c'est-à-dire exactement toute la population de taille $N$ et on calcule $\widehat{  p^{Max} }\left({\mathbf{ { y^{Max} } }}\right) := \displaystyle \frac1N \sum_{i=1}^n y_i^{Max}$</label>
</div><!--/div-->
</div>
	</div><!-- fin two columns -->


<div class="ok answer">
<button id="ok_max_ech_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_max_ech">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Une solution consiste à interroger un nombre $n << N$ d'individus. Ce jeu de données pourrait être noté ${\mathbf{  y^{Max}  }}$ et le remplaçant de $p^{Max}$ pourrait alors être calculé par $\widehat{  p^{Max} }\left({\mathbf{ { y^{Max} } }}\right):=\displaystyle \frac1n \sum_{i=1}^n y_i^{Max}=\overline{y^{Max}}$.
</div></div></div>

</div>


<br/>(3) Deux personnes se proposent d'interroger chacun $n=1000$ électeurs. On notera ${\mathbf{  y_{[1]}  }}$ et ${\mathbf{  y_{[2]}  }}$ ces deux jeux de données recueillis. Les estimations correspondantes sont respectivement de $47\%$ et $52\%$. Comment interpréter la différence des résultats qui, si on leur fait une confiance aveugle, conduit à deux conclusions différentes?

<div class="ui one column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q3" name="c1">
<label>La différence ne peut pas s'expliquer.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q3" name="c2">
<label>La différence des résultats peut s'expliquer par le fait qu'un échantillon de taille n ne constitue qu'une sous-information de la population de taille N.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q3" name="c3">
<label>La différence peut s'expliquer par le fait que les 1000 électeurs correspondant à ${\mathbf{  y_{[1]}  }}$ peuvent avoir été choisis dans la capitale et ceux correspondant à ${\mathbf{  y_{[2]}  }}$ peuvent avoir été choisis dans une ville de province.</label>
</div><!--/div-->
</div>
	</div><!-- fin one columns -->


<div class="ok answer">
<button id="ok_max_2echs_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_max_2echs">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>La différence des résultats peut s'expliquer par le fait qu'un échantillon de taille $n$ ne constitue qu'une sous-information de la population de taille $N$.
</div></div></div>

</div>


<br/>(4)Connaissez-vous d'autres applications nécessitant une estimation d'un paramètre inconnu ?
<div class="ui two column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q4" name="c1">
<label>durée de vie d'un téléphone portable</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q4" name="c2">
<label>normes de production, normes écologiques,...</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q4" name="c3">
<label>prix de l'électricité</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="presMax" question="q4" name="c4">
<label>nombre de personnes ayant un effet secondaire suite à l'ingestion d'un médicament</label>
</div><!--/div-->
</div>
	</div><!-- fin two columns -->

<div class="ok answer">
<button id="ok_max_autres_pbs_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_max_autres_pbs">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>normes de production, normes écologiques, ... </div></div></div>

</div>


<h2> Exercice 2 : Présentation des problématiques des produits A et B</h2>


<div class="ui yellow message">
Un industriel veut lancer sur le marché deux produits que l'on nommera Produit $A$ et Produit $B$. Le Produit $A$ est acheté au plus une fois par mois tandis que le Produit $B$ peut être acheté autant de fois que désiré. Après une étude financière, les services comptables indiquent à cet industriel que pour que le lancement de chacun de ces produits soit rentable, il faut qu'il soit vendu à plus de 300000 exemplaires par mois. La population ciblée par l'industriel est une population de taille $N=2000000$. L'industriel se demande s'il doit ou non lancer le(s) <em>Produit(s) A et/ou B</em>. 
</div>


<button class="ui mini blue icon button" id="questions-btn-indus"><i class="calculator icon"></i></button> 
<div class="ui teal message" id="questions-result-indus-toggle" ><div id="questions-result-indus"></div></div>

<br/>

Commençons par introduire quelques notations permettant de décrire le choix d'achat des individus de la population totale (ciblée par l'industriel). Les deux études des Produit $A$ et Produit $B$ étant plutôt similaires, nous noterons donc dans un cadre général  $\bullet$ aussi bien à la place de $A$ ou $B$. Ainsi  
$\mathcal{Y}^{\bullet}_i$ représente le nombre de produit(s) $\bullet$ acheté(s) par le $i^{\grave eme}$ ($i=1,\cdots,N$) individu de la population totale. L'ensemble des choix d'achat des $N$ individus $\left(\mathcal{Y}_i^\bullet\right)_{i=1,\cdots,N}$ sera noté $\pmb{\mathcal{Y}}^{ \bullet}$. $N^{\bullet}$ désignera le nombre d'exemplaires de Produit $\bullet$ achetés par les N individus de la population. 

<br/>(1) Exprimez $N^A$ (resp. $N^B$) en fonction des  $\pmb{\mathcal{Y}}^{ A}$ (resp. $\pmb{\mathcal{Y}}^{ B}$). Exprimez la rentabilité du Produit $A$ (resp. Produit $B$) en fonction du nombre total $N^A$ (resp. $N^B$) d'exemplaires du Produit $A$ (resp. Produit $B$) vendus.
 
<div class="ui two column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q1a" name="c1">
<label>$N^{\bullet}:= \displaystyle \sum_{i=1}^N \mathcal{Y}_i^{\bullet}$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q1a" name="c2">
<label>$N^{\bullet} := N \times \left(\mathcal{Y}_1^{\bullet} + \mathcal{Y}_2^{\bullet} + \cdots + \mathcal{Y}_N^{\bullet}\right)$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q1a" name="c3">
<label>$N^{\bullet} := \mathcal{Y}_1^{\bullet} + \mathcal{Y}_2^{\bullet} + \cdots + \mathcal{Y}_N^{\bullet}$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q1a" name="c4">
<label>$N^{\bullet} := \displaystyle \frac1N \sum_{i=1}^N \mathcal{Y}_i^{\bullet}$</label>
</div><!--/div-->
</div>
	</div><!-- fin two columns -->


<div class="ui two column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q1b" name="c1">
<label>Le produit $\bullet$ est rentable si $N^\bullet := \displaystyle \sum_{i=1}^N \mathcal{Y}_i^{\bullet} =  300 000$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q1b" name="c2">
<label>Le produit $\bullet$ est rentable si $N^\bullet := \displaystyle \sum_{i=1}^N \mathcal{Y}_i^{\bullet} >  300 000$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q1b" name="c3">
<label>Le produit $\bullet$ est rentable si $N^\bullet := \displaystyle \sum_{i=1}^N \mathcal{Y}_i^{\bullet} \leq 300 000$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q1b" name="c4">
<label>Le produit $\bullet$ est rentable si $N^\bullet := \displaystyle \sum_{i=1}^N \mathcal{Y}_i^{\bullet} <  300 000$</label>
</div><!--/div-->
</div>
	</div><!-- fin two columns -->


<div class="ok answer">
<button id="ok_prodAB_q1_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_prodAB_q1">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Le produit $\bullet$ est rentable si $N^\bullet:=\displaystyle\sum_{i=1}^N \mathcal{Y}_i^\bullet > 300000$.</div></div></div>

</div>

<br/>(2) Même question mais en fonction du nombre moyen (par individu de la population) $\mu^A$ (resp. $\mu^B$) d'exemplaires du Produit $A$ (resp. Produit $B$) en ayant au préalable établi la relation entre $\mu^A$ et $N^A$ (resp. $\mu^B$ et $N^B$) et ainsi entre $\mu^A$ et $\pmb{\mathcal{Y}}^{ A}$ (resp. $\mu^B$ et $\pmb{\mathcal{Y}}^{ B}$). Quelle relation y a-t-il donc entre $\mu^A$ et $\overline{\mathcal{Y}^A}$ (resp. entre $\mu^B$ et $\overline{\mathcal{Y}^B}$) ?

<div class="ui yellow message">Les quantités $\mu^A$ et $\mu^B$ seront appelées <b>paramètres d'intérêt</b>.</div>

<div class="ui two column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q2a" name="c1">
<label>$\mu^\bullet := \displaystyle N \times N^\bullet$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q2a" name="c2">
<label>$\mu^\bullet := \displaystyle \frac{N}{N^\bullet}$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q2a" name="c3">
<label>$\mu^\bullet := \displaystyle N + N^\bullet$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q2a" name="c4">
<label>$\mu^\bullet := \displaystyle \frac{N^\bullet}{N}$</label>
</div><!--/div-->
</div>
	</div><!-- fin two columns -->


<div class="ui two column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q2b" name="c1">
<label>Le produit $\bullet$ est rentable si $\mu^\bullet > \frac{300 000}{2 000 000}$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q2b" name="c2">
<label>Le produit $\bullet$ est rentable si $\mu^\bullet > 0.14$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q2b" name="c3">
<label>Le produit $\bullet$ est rentable si $\mu^\bullet > 0.15$</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q2b" name="c4">
<label>Le produit $\bullet$ est rentable si $\mu^\bullet = \frac{300 000}{2 000 000}$</label>
</div><!--/div-->
</div>
	</div><!-- fin two columns -->


<div class="ok answer">
<button id="ok_prodAB_q2_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_prodAB_q2">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Le produit $\bullet$ est rentable si $\mu^\bullet:=\displaystyle\frac1N\sum_{i=1}^N \mathcal{Y}_i^\bullet = \overline{\mathcal{Y^\bullet}} > \frac{300000}{2000000}=0.15$.</div></div></div>

</div>

<br/>(3) Est-il possible pour l'industriel de ne pas se tromper dans sa décision quant au lancement de chaque produit ? Si oui, comment doit-il procéder ? Cette solution est-elle réalisable ? 

<div class="ui two column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q3" name="c1">
<label>L'industriel ne peut pas se tromper et ne devrait pas lancer ses produits.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q3" name="c2">
<label>L'industriel peut se tromper quant au lancement de chaque produit. Il ne peut pas être certain que son produit sera rentable. Le seul moyen de le savoir est de le lancer.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q3" name="c3">
<label>L'industriel ne peut pas se tromper et devrait lancer ses produits.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q3" name="c4">
<label>L'industriel ne sait pas si son produit sera rentable mais peut décider de demander à un nombre $n$ de personnes s'ils comptent acheter son produit et prendre une décision.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q3" name="c5">
<label>Pour ne pas se tromper, il lui faut recueillir les intentions des $N$ individus ce qui paraît peu réalisable.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q3" name="c6">
<label>L'industriel ne peut pas se tromper</label>
</div><!--/div-->
</div>
	</div><!-- fin two columns -->


<div class="ok answer">
<button id="ok_prodAB_q3_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_prodAB_q3">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Pour ne pas se tromper, il lui faut recueillir les intentions des $N$ individus ce qui paraît peu réalisable.</div></div></div>

</div>

<br/>(4) Est-il alors possible d'évaluer (exactement) les paramètres d'intérêt ? Comment les qualifieriez-vous par la suite ?
 
<div class="ui one column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q4" name="c1">
<label>Les paramètres d'intérêt peuvent être évalués et seront donc considérés comme CONNUS.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q4" name="c2">
<label>Les paramètres d'intérêt ne peuvent donc pas être évalués et sont donc considérés comme INCONNUS.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q4" name="c3">
<label>Cela dépend des cas. On ne peut donc pas les qualifiez.</label>
</div><!--/div-->
</div>
	</div><!-- fin one columns -->


<div class="ok answer">
<button id="ok_prodAB_q4_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_prodAB_q4">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Les paramètres d'intérêt ne peuvent donc pas être évalués et sont donc considérés comme INCONNUS.</div></div></div>

</div>

<br/>(5) Une solution réalisable est alors de n'interroger qu'une sous-population de taille raisonnable $n << N$ (ex $n=1000$). On notera alors ${\mathbf{  y  }}^\bullet$ le jeu de données (appelé aussi échantillon), i.e. le vecteur des $n$ nombres d'achat $\left(y_i^\bullet\right)_{i=1,\cdots,n}$ du produit $\bullet$ des $n$ ($n << N$) individus interrogés.

<div class="ui yellow message">Cet unique jeu de données ${\mathbf{  y
\bullet  }}$ sera créé un jour particulier, le <b>jour J</b>. Ce jour là (et seulement ce jour là) nous pourrons décider ou pas de lancer le produit $\bullet$ sur le marché.</div>

Chronologiquement, tous les raisonnements qui se situeront <b>avant le jour J</b> seront consacrés à la mise en place de l'outil d'aide à la décision. 


Comment l'industriel pourra-t-il évaluer un remplaçant de $\mu^\bullet$ à partir de son échantillon ${\mathbf{  y  }}^\bullet$ ? 
 
<div class="ui yellow message">
Cette quantité désomais notée $\widehat{  \mu^{\bullet} }\left({\mathbf{ { y^{\bullet} } }}\right)$ se traduit littéralement par ``remplaçant" de $\mu^\bullet$ obtenu à partir du vecteur des données ${\mathbf{  y  }}$ ( <i>convention:</i> le symbole <u>accent circonflexe</u> sur un paramètre signifie <b>estimation</b> ou ``remplaçant" de celui-ci et les symboles <u>parenthèses</u> contiennent les informations nécessaires pour son obtention). 
</div>

(quelle est la relation entre $\overline{y^\bullet}$, représentant la moyenne empirique des $\left(y_i^\bullet\right)_{i=1,\ldots,n}$, et l'estimation $\widehat{  \mu^{\bullet} }\left({\mathbf{ { y^{\bullet} } }}\right)$ ?)

<div class="ui one column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q5" name="c1">
<label>En évaluant la moyenne sur l'échantillon observé, i.e. en calculant $\widehat{  \mu^{\bullet} }\left({\mathbf{ { y^{\bullet} } }}\right)=\displaystyle n \times \sum_{i=1}^n y_i^\bullet=\overline{y^\bullet}$.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q5" name="c2">
<label>En évaluant la moyenne sur l'échantillon observé, i.e. en calculant $\widehat{  \mu^{\bullet} }\left({\mathbf{ { y^{\bullet} } }}\right)=\displaystyle\frac1n \sum_{i=1}^n y_i^\bullet=\overline{y^\bullet}$.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q5" name="c3">
<label>En évaluant la moyenne sur l'échantillon observé, i.e. en calculant $\widehat{  \mu^{\bullet} }\left({\mathbf{ { y^{\bullet} } }}\right)=\displaystyle \sum_{i=1}^n y_i^\bullet=\overline{y^\bullet}$.</label>
</div><!--/div-->
</div>
	</div><!-- fin one columns -->


<div class="ok answer">
<button id="ok_prodAB_q5_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_prodAB_q5">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>En évaluant la moyenne sur l'échantillon observé, i.e. en calculant $\widehat{  \mu^{\bullet} }\left({\mathbf{ { y^{\bullet} } }}\right)=\displaystyle\frac1n \sum_{i=1}^n y_i^\bullet=\overline{y^\bullet}$.</div></div></div>

</div>

<br/>(6) Quelle est la nature du paramètre d'intérêt $\mu^A$ dans le cas où les données ne sont que des 0 et 1 ? Désormais cette moyenne, puisqu'elle bénéficiera d'un traitement particulier, sera notée $p^A=\mu^A$.

<div class="ui one column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q6" name="c1">
<label>Une moyenne de 0 et de 1 est un réel compris entre 0 et 1.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q6" name="c2">
<label>Un réel compris entre 0 et 1 est une proportion.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q6" name="c3">
<label>Une moyenne de 0 et de 1 correspond à une proportion.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="indus" question="q6" name="c4">
<label>Une moyenne n'est jamais une proportion.</label>
</div><!--/div-->
</div>
	</div><!-- fin one columns -->


<div class="ok answer">
<button id="ok_prodAB_q6_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_prodAB_q6">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Une moyenne de 0 et de 1 correspond à une proportion.</div></div></div>

</div>


<h2> Exercice 3 : Procédé de construction d'échantillon</h2>

Dans le but d'estimer un paramètre d'intérêt inconnu, on dispose d'un échantillon. Nous nous proposons maintenant de préciser plus en détail son procédé de construction. <br/>

<button class="ui mini blue icon button" id="questions-btn-ech"><i class="calculator icon"></i></button> 
<div class="ui teal message" id="questions-result-ech-toggle" ><div id="questions-result-ech"></div></div>

<br/>

<br/>(1) Proposez des critères de qualité d'un tel échantillon.
<br/>(2) A quoi correspond la notion de représentativité ?

<div class="ok answer">
<button id="ok_procEch_q1_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_procEch_q1">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>à essayer de faire "ressembler" l'échantillon à la population totale.</div></div></div>

</div>

<br/>(3) Est-il possible de construire un échantillon représentatif d'une (ou plusieurs) caractéristique(s) donnée(s) ?

<div class="ok answer">
<button id="ok_procEch_q2_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_procEch_q2">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>oui par exemple en tentant de respecter la proportion de femmes dans la population totale avec la proportion de femmes présentes dans l'échantillon.</div></div></div>

</div>


<br/>(4) Même question sans aucun a priori (i.e. aucune caractéristique fixée).
<br/>(5) Proposez un critère de qualité  qui permettra de construire un échantillon le plus représentatif sans aucun a priori.
 
<div class="ok answer">
<button id="ok_procEch_q3_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_procEch_q3">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>voir réponse ci-après.</div></div></div>

</div>

<br/>(6) Fournissez un (ou plusieurs) procédé(s) d'échantillonnage satisfaisant au critère suivant de représentativité (maximale) sans a priori (RSAP) :
<div class="ui yellow message">
<b>Tous</b> les individus de la population totale ont la même chance d'être choisi dans l'échantillon. 
</div>

<div class="ui one column stackable divided grid segment">
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="ech" question="q6" name="c1">
<label>A la fois les procédés d'échantillonnage avec et sans remise satisfont le critère RSAP.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="ech" question="q6" name="c2">
<label>Seul le procédé d'échantillonnage avec  remise satisfait le critère RSAP.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="ech" question="q6" name="c3">
<label>Seul le procédé d'échantillonnage sans  remise satisfait le critère RSAP.</label>
</div><!--/div-->
</div>
	
<div class="column">
<!--div class="ui segment"--><div class="ui toggle checkbox">
<input type="checkbox" class="questions quizz" exo="ech" question="q6" name="c4">
<label>Aucun des procédés d'échantillonnage avec et sans remise satisfont le critère RSAP.</label>
</div><!--/div-->
</div>
	</div><!-- fin one columns -->


<div class="ok answer">
<button id="ok_procEch_q4_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_procEch_q4">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Selon ce critère, on pourrait choisir $n$ individus au hasard au sein de la population avec remise et sans remise. Notons qu'étant donné les ordres de grandeurs, $n=1000$ et $N=2000000$ ces deux procédés sont quasiment équivalents.</div></div></div>

</div>

<br/>(7) Si on répète le procédé d'échantillonnage suivant le critère RSAP et que pour chaque échantillon on évalue l'estimation du paramètre d'intérêt, pensez-vous que les résultats seront toujours les mêmes ? Comment qualifie-t-on alors la nature du procédé d'échantillonnage ?

<div class="ok answer">
<button id="ok_procEch_q5_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_procEch_q5">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>L'échantillonnage est dit aléatoire.</div></div></div>

</div>


<h2> Exercice 4 : Outil d'estimation par Intervalle de Confiance (IC) pour la problématique des élections</h2>


On se propose d'estimer le paramètre d'intérêt en fournissant un intervalle (ou fourchette, encadrement) obtenu à partir des données. Cet intervalle, appelé intervalle de confiance, est centré en la valeur de l'estimation et sa largeur dépend d'un niveau de confiance que l'on se fixe (généralement plutôt grand, par exemple, $95\%$).

<br/>(1) Pensez-vous qu'il soit possible qu'une estimation $\widehat{  p }\left({\mathbf{ { y } }}\right)$ soit égale au paramètre d'intérêt (à estimer) ? Pouvez-vous savoir l'ordre de grandeur de l'écart entre l'estimation et le paramètre inconnu?
Quel niveau de confiance accordez-vous à la valeur d'une estimation (dans notre exemple, $47\%$ et $52\%$ sur deux échantillons)?

<div class="ok answer">
<button id="ok_maxICSuite_q1_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_maxICSuite_q1">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Excepté dans de très rares contextes, une estimation ne peut pas correspondre à la vraie valeur du paramètre inconu. Il n'y a aucun moyen de mesurer avec certitude l'écart entre l'estimation et le paramètre. Cependant, on peut seulement espérer qu'ils ne sont pas très éloignés. Compte tenu ce ces réponses, il est alors difficile de répondre à la dernière question autrement que de proposer un avis personnel plutôt arbitraire.</div></div></div>

</div>

<br/>(2) Si on vous annonce qu'un statisticien sait généralement fournir en plus de l'estimation du paramètre, l'estimation de sa fiabilité mesurée en terme de variabilité attendue, quel est la mission principale d'un intervalle de confiance ? Quelles sont les qualités souhaitées d'un intervalle de bonne confiance ($95\%$ par exemple) du paramètre d'intérêt (inconnu) ? 

<div class="ok answer">
<button id="ok_maxICSuite_q2_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_maxICSuite_q2">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>L'objectif est d'intégrer dans le procédé d'estimation du paramètre sa fiabilité (voir énoncé) afin de fournir un intervalle plus ou moins large selon le niveau de confiance  fixé.
La qualité attendue est que cet intervalle ait de bonnes chances (traduites par le niveau de confiance) de contenir le paramètre d'intérêt inconnu. En outre, on peut espérer obtenir un intervalle de longueur raisonnablement faible pour que l'estimation soit suffisamment informative (bien que l'on ne peut en être assuré en général).</div></div></div>

</div>

<br/>(3) Compléter les phrases suivantes : <button id="ok_maxIC_toggle" class="ui icon mini icon green button"><i class="check icon"></i></button>

<ol>
<li> PLUS le niveau de confiance est fort, <span class="hidden_ok_maxIC">....</span><span class="ok_maxIC">MOINS</span>
 l'intervalle de confiance est petit.</li>
<li> Vue comme un intervalle de confiance de largeur 0, une estimation peut donc être associé à un niveau de confiance <span class="hidden_ok_maxIC">....</span><span class="ok_maxIC">$0\%$</span>
.</li>
</ol>

<br/>(4) Un statisticien construit les intervalles à $95\%$ de confiance (via une formule d'obtention étudiée plus tard dans le cours ne faisant pas l'objet) et informe le candidat que les intervalles associés aux estimations $47\%$ et $52\%$ sont respectivement $[43.90655\%,50.09345\%]$ et $[48.90345\%,55.09655\%]$. Les élections effectuées, on évalue $p^{Max}=51.69\%$, qu'en pensez-vous ?

<div class="ok answer">
<button id="ok_maxICSuite_q3_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_maxICSuite_q3">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Il semble qu'il soit difficile d'affirmer que le candidat sera élu.</div></div></div>

</div>

<br/>(5) Si vous avez des difficultés à traduire ce que signifie le niveau de confiance d'un intervalle, comparez-le avec celui que vous accorderiez à une personne qui serait censée dire la vérité avec un niveau de confiance fixé à $95\%$. Dans le cas de cette personne, comment traduiriez-vous (ou expliqueriez-vous) le concept de niveau de confiance ? 
<div class="ok answer">
<button id="ok_maxICSuite_q4_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_maxICSuite_q4">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Parmi toutes les assertions énoncées par cette personne (dont on peut vérifier la véracité ou fiabilité), $95\%$ (en moyenne) seraient censées être justes ou fiables.</div></div></div>

</div>


<div class="ui yellow message">Cet exemple nous aide à appréhender la notion de niveau de confiance ou plus généralement de probabilité d'un événement en l'exprimant comme la proportion parmi toutes (en théorie, on peut imaginer en faire une infinité) réalisations de l'expérience (a priori supposée aléatoire) qui conduisent à ce que l'événement soit vérifié. Ceci nous conduit naturellement vers la notion d'Approche Expérimentale des Probabilités qui sera présentée dans la fiche de Td suivante en complément de l'Approche Mathématique des Probabilités (qui est classiquement présentée dans les cours de Probabilités et Statistique).</div>


<h2> Exercice 5 : Outil d'aide à la décision pour la problématique de l'industriel</h2>

Pour achever cette présentation des outils proposés dans ce cours cette année, proposons la mise en pratique de l'outil d'aide à la décision pour la problématique de l'industriel. 
Mettons-nous dans la peau de l'industriel, nous sommes le jour J et les jeux de données ${\mathbf{  y^A  }}$ et ${\mathbf{  y^B  }}$ ont été collectés et on obtient :
<pre class="solarized">
<span class="Variable">R</span><span class="Keyword">&gt;</span> c(length(<span class="Variable">yA</span>),length(<span class="Variable">yB</span>))
[<span class="Number">1</span>] <span class="Number">1000</span> <span class="Number">1000</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> mean(<span class="Variable">yA</span>)
[<span class="Number">1</span>] <span class="Number">0.204</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> c(mean(<span class="Variable">yB</span>),sd(<span class="Variable">yB</span>))
[<span class="Number">1</span>] <span class="Number">0.1720000</span> <span class="Number">0.5610087</span>

</pre><br/>(1) Êtes-vous en mesure avec ces informations de prendre votre décision quant aux lancements des produits A et B ?
<div class="ok answer">
<button id="ok_pValProdAB_q1_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_pValProdAB_q1">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Les estimations sont bien supérieures au seuil de rentabilité $0.15$. Pour autant, elles ne sont obtenues que sur des échantiilons, ici de taille $n=1000$. Bien que ces échantillons soient plutôt de grande taille, ils restent de tailles relativement petites devant celle de la population des acheteurs potentiels N=2000000. En l'état, il est alors difficile de prendre une décision n'ayant pas véritablement de notion des risques encourus.</div></div></div>

</div>

<br/>(2) L'industriel demande alors conseil à un expert en statisque inférentielle (que vous deviendrez en suivant ce cours si vous le souhaitez). Ce dernier, en utilisant son logiciel préféré <em>R</em>, lui propose les calculs en <em>R</em> des p-valeurs (dont on ne cherchera pas à en comprendre le sens car ces formules ne seront compréhensibles que dans 2 ou 3 cours) : 
<pre class="solarized">
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Comment"><span class="Comment">#</span> p-valeur pour le produit A</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Number">1</span><span class="Keyword">-</span>pnorm((mean(<span class="Variable">yA</span>)<span class="Keyword">-</span><span class="Number">0.15</span>)<span class="Keyword">/</span>sqrt((<span class="Number">0.15</span><span class="Keyword">*</span><span class="Number">0.85</span>)<span class="Keyword">/</span>length(<span class="Variable">yA</span>)))
[<span class="Number">1</span>] <span class="Number">8.66416e-07</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Comment"><span class="Comment">#</span> p-valeur pour le produit B</span>
<span class="Variable">R</span><span class="Keyword">&gt;</span> <span class="Number">1</span><span class="Keyword">-</span>pnorm((mean(<span class="Variable">yB</span>)<span class="Keyword">-</span><span class="Number">0.15</span>)<span class="Keyword">/</span>seMean(<span class="Variable">yB</span>))
[<span class="Number">1</span>] <span class="Number">0.1074711</span>

</pre>et lui dit que la valeur d'une p-valeur (à convertir de préférence en pourcentage) nous fournit le risque de se tromper au vu du jeu de donnée s'il décide de lancer le produit sur le marché.
<br/>Êtes-vous maintenant en mesure avec ces informations de prendre votre décision quant aux lancements des produits A et B ?
<div class="ok answer">
<button id="ok_pValProdAB_q2_answer" class="ui icon mini icon green button"><i class="check icon"></i></button>

<div class="ok_pValProdAB_q2">
<div class="ui icon blue message"><i class="life ring icon"></i><div class="content"><div class="header">Réponse</div>Les p-valeurs nous fornissent la notion de risques encourus que nous ne disposions pas à la question précédente. Il est alors direct de prendre sa décision quant aux lancements des produits A et B en définissant ce qui est un risque raisonnablement faible. Ici, c'est l'industriel qui prend véritablement le risque (ici de devenir pauvre comme on le verra en poursuivant le cours). Soulignons toutefois qu'en général, le risque encouru est pris par tout le monde et dans ce cas on s'entend sur un consensus stipulant qu'un risque raisonnable est égal à 5% (voire 1% ou 1O% selon la dangerosité/importance du contexte). Comme vous êtes à la place de l'industriel, libre à vous de prendre la décision selon votre votre ressenti de ce qu'est un risque raisonnablement petit.</div></div></div>

</div>


<br/><br/>


</div>

 <script type="module">
        /* Create a webR console using the Console helper class */
        import { Console } from 'https://webr.r-wasm.org/latest/webr.mjs';
        let sessionOut = ace.edit("ace_editor_webrout").getSession();
        
        let canvas = null;
        let lastCanvas = null;
        let container = document.getElementById('plot-container');
        lastCanvas = document.createElement('canvas');
        lastCanvas.setAttribute('width', '1008');
        lastCanvas.setAttribute('height', '1008');
        lastCanvas.style.width = "100%";
        lastCanvas.style.height = "450px";
        lastCanvas.style.display = "inline-block";
        container.appendChild(lastCanvas);
      
      const webRConsole = new Console({
        stdout: line => sessionOut.insert({row: sessionOut.getLength(),column: 0}, line + '\n'),
        stderr: line => sessionOut.insert({row: sessionOut.getLength(),column: 0}, line + '\n'),
        prompt: p => sessionOut.insert({row: sessionOut.getLength(),column: 0}, p),
        canvasImage: (image) => canvas.getContext('2d').drawImage(image, 0, 0),
        canvasNewPage: () => {
            canvas = document.createElement('canvas');
            canvas.setAttribute('width', '1008');
            canvas.setAttribute('height', '1008');
            canvas.style.width = "100%";
            canvas.style.height = "450px";
            canvas.style.display = "inline-block";
            if(lastCanvas != null) {
                container.removeChild(lastCanvas);
            }
            container.appendChild(canvas);
            lastCanvas = canvas;
        }
      });
      webRConsole.run();
      globalThis.evalRCode = async (code) => {
        let result = await webRConsole.webR.evalR(code);
        let output = await result.toJs();
        return output;
    }
    
    
await webRConsole.webR.evalRVoid(atob(`LmZucyA8LSBuZXcuZW52KCkKbG9jYWwoewpuZXdfZW52IDwtIGZ1bmN0aW9u
KC4uLikgewogICAgb2JqIDwtIG5ldy5lbnYoKQogICAgYXJncyA8LSBsaXN0
KC4uLikKICAgIGZvcihrZXkgaW4gbmFtZXMoYXJncykpIHsKICAgICAgICBh
c3NpZ24oa2V5LCBhcmdzW1trZXldXSwgZW52aXIgPSBvYmopCiAgICB9CiAg
ICBjbGFzcyhvYmopIDwtICJlbnYiCiAgICByZXR1cm4ob2JqKQp9CgpuYW1l
cy5lbnYgPC0gZnVuY3Rpb24oZW52KSBscyhlbnYpCgoiW1suZW52IiA8LSBm
dW5jdGlvbihlbnYsIGtleSkgewogICAgZ2V0KGtleSwgZW52aXIgPSBlbnYp
Cn0KCiJbWzwtLmVudiIgPC0gZnVuY3Rpb24oZW52LCBrZXksIHZhbHVlKSB7
CiAgICBhc3NpZ24oa2V5LCB2YWx1ZSwgZW52aXIgPSBlbnYpCn0KCnByaW50
LmVudiA8LSBmdW5jdGlvbihlbnYpIHsKICAgIGZvcihvYmogaW4gbmFtZXMo
ZW52KSkgewogICAgICAgIGNhdCgiJCIsIG9iaiwgIlxuIiwgc2VwPSIiKQog
ICAgICAgIHByaW50KGVudltbb2JqXV0pCiAgICB9Cn0KCmFzLmxpc3QuZW52
IDwtIGZ1bmN0aW9uKGVudikgewogICAgcmVzIDwtIGxpc3QoKQogICAgZm9y
KG9iaiBpbiBuYW1lcyhlbnYpKSB7CiAgICAgICAgaWYoaW5oZXJpdHMoZW52
W1tvYmpdXSwgImVudiIpIHx8IGlzLmVudmlyb25tZW50KGVudltbb2JqXV0p
KSB7CiAgICAgICAgICAgIHJlc1tbb2JqXV0gPC0gYXMubGlzdChlbnZbW29i
al1dKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlc1tbb2JqXV0g
PC0gZW52W1tvYmpdXQogICAgICAgIH0KICAgIH0KICAgIHJlcwp9CgojIyBX
aGVuIGNhbGxlZCB3aXRob3V0IE5BTUVTUEFDRSBwYWNrYWdlCnJlZ2lzdGVy
X2Vudl9tZXRob2RzIDwtIGZ1bmN0aW9uKCkgewogICAgLlMzbWV0aG9kKCJu
YW1lcyIsICJlbnYiLCBuYW1lcy5lbnYpCiAgICAuUzNtZXRob2QoInByaW50
IiwgImVudiIsIHByaW50LmVudikKICAgIC5TM21ldGhvZCgiYXMubGlzdCIs
ICJlbnYiLCBhcy5saXN0LmVudikKICAgIC5TM21ldGhvZCgiW1siLCAiZW52
IiwgYFtbLmVudmApCiAgICAuUzNtZXRob2QoIltbPC0iLCAiZW52IiwgYFtb
PC0uZW52YCkKICAgIC5TM21ldGhvZCgidXBkYXRlIiwgInF1ZXN0aW9uX2lu
cHV0IiwgdXBkYXRlLnF1ZXN0aW9uX2lucHV0KQogICAgLlMzbWV0aG9kKCJ1
cGRhdGUiLCAicXVlc3Rpb25fcXVpenoiLCB1cGRhdGUucXVlc3Rpb25fcXVp
enopCn0gCgpnZXRfZXhvIDwtIGZ1bmN0aW9uKGlkKSB7CiAgICBpZiAoIWV4
aXN0cygiLmV4b0NxbHMiLCBlbnZpciA9IC5HbG9iYWxFbnYpKSB7CiAgICAg
ICAgYXNzaWduKCIuZXhvQ3FscyIsIG5ld19lbnYoaWQgPSAiLmV4b0NxbHMi
KSwgZW52aXIgPSAuR2xvYmFsRW52KQogICAgfQogICAgZXhvcyA8LSBnZXQo
Ii5leG9DcWxzIiwgZW52aXIgPSAuR2xvYmFsRW52KQogICAgaWYgKGlkICVp
biUgbmFtZXMoZXhvcykpIHsKICAgICAgICBleG9zW1tpZF1dCiAgICB9IGVs
c2UgewogICAgICAgIGV4byA8LSBuZXdfZW52KGlkID0gaWQsIHF1ZXN0aW9u
cyA9IGxpc3QoKSkKICAgICAgICBjbGFzcyhleG8pIDwtIGMoImV4byIsIGNs
YXNzKGV4bykpCiAgICAgICAgZXhvc1tbaWRdXSA8LSBleG8KICAgICAgICBl
eG8KICAgIH0KfQoKYWRkX3RleHRfcXVlc3Rpb24gPC0gZnVuY3Rpb24odGV4
dCkgewogICAgdG1wIDwtIHN0cnNwbGl0KHRleHQsICItPiIpW1sxXV0KICAg
IG1vZGUgPC0gdG1wWzJdCiAgICBzb2x1dGlvbiA8LSBzdHJzcGxpdCh0bXBb
M10sICJcXHxcXHxcXHwiKVtbMV1dCiAgICByY29kZSA8LSB0bXBbNF0gIyBu
b3QgdG1wW1s0XV0gd2hpY2ggY2FuIGJlIG91dCBvdSBib3VuZHMgd2hlbiB0
bXBbNF0gaXMgTkEKICAgIHRtcDIgPC0gc3Ryc3BsaXQodG1wWzFdLCAiXFwu
IilbWzFdXQogICAgZXhvX2lkIDwtIHRtcDJbMV0KICAgIHFfaWQgPC0gdG1w
MlsyXQogICAgZXhvIDwtIGdldF9leG8oZXhvX2lkKQogICAgcXVlc3RzIDwt
IGxpc3QoKQogICAgcXVlc3RzW1txX2lkXV0gPC0gbGlzdChtb2RlLCBzb2x1
dGlvbikKICAgIGlmICghKG1vZGUgJWluJSBjKCJxdWl6eiIsICJyYXciKSkg
JiYgIWlzLm5hKHJjb2RlKSkgewogICAgICAgIHF1ZXN0c1tbcV9pZF1dW1sz
XV0gPC0gcmNvZGUKICAgIH0KICAgIGFkZF9xdWVzdGlvbnMoZXhvLCBxdWVz
dHMpCn0KCnNlbmRfcmVwb25zZV9xdWl6eiA8LSBmdW5jdGlvbih0ZXh0KSB7
CiAgICB0bXAgPC0gc3Ryc3BsaXQodGV4dCwgIi0+IilbWzFdXQogICAgdG1w
MiA8LSBzdHJzcGxpdCh0bXBbMV0sICJcXC4iKVtbMV1dCiAgICBleG9faWQg
PC0gdG1wMlsxXQogICAgcV9pZCA8LSB0bXAyWzJdCiAgICBleG8gPC0gZ2V0
X2V4byhleG9faWQpCiAgICBpZiAoaXMubmEodG1wWzJdKSkgdG1wWzJdIDwt
ICIiCiAgICByZXBvbnNlIDwtIHN0cnNwbGl0KHRtcFsyXSwgIlxcfFxcfFxc
fCIpW1sxXV0KICAgICMjIEFkZCByZXBvbnNlCiAgICBhZGRfcmVwb25zZShl
eG8sIHFfaWQsIHJlcG9uc2UpCiAgICBxdWVzdCA8LSBleG8kcXVlc3Rpb25z
W1txX2lkXV0KICAgICMjIHVwZGF0ZSBzY29yZQogICAgdXBkYXRlKHF1ZXN0
KQogICAgcmV0dXJuKGdldF9zY29yZShleG8pKQp9CgpzZW5kX3JlcG9uc2Vf
dGV4dGFyZWEgPC0gZnVuY3Rpb24odGV4dCkgewogICAgdG1wIDwtIHN0cnNw
bGl0KHRleHQsICItPiIpW1sxXV0KICAgIHRtcDIgPC0gc3Ryc3BsaXQodG1w
WzFdLCAiXFwuIilbWzFdXQogICAgZXhvX2lkIDwtIHRtcDJbMV0KICAgIHFf
aWQgPC0gdG1wMlsyXQogICAgZXhvIDwtIGdldF9leG8oZXhvX2lkKQogICAg
cmVwb25zZSA8LSAiIgogICAgcmVwb25zZV9yY29kZSA8LSAiIgogICAgaWYg
KGlzLm5hKHRtcFsyXSkpIHsKICAgICAgICB0bXBbMl0gPC0gIiIKICAgIH0g
ZWxzZSB7CiAgICAgICAgdG1wMyA8LSBzdHJzcGxpdCh0bXBbMl0sICJcXG4i
KVtbMV1dCiAgICAgICAgcmVwb25zZSA8LSB0bXAzW1tsZW5ndGgodG1wMyld
XQogICAgICAgIHJlcG9uc2VfcmNvZGUgPC0gcGFzdGUodG1wM1stbGVuZ3Ro
KHRtcDMpXSwgY29sbGFwc2UgPSAiXFxuIikKICAgIH0KICAgIHF1ZXN0IDwt
IGV4byRxdWVzdGlvbnNbW3FfaWRdXQogICAgcXVlc3QkcmVwb25zZV9yY29k
ZSA8LSByZXBvbnNlX3Jjb2RlCiAgICAjIyBBZGQgcmVwb25zZQogICAgYWRk
X3JlcG9uc2UoZXhvLCBxX2lkLCByZXBvbnNlKQogICAgIyMgQ2FwdHVyZSBm
b3IgcmVwb25zZSBpcyB1cGRhdGVkCiAgICBhZGRfY2FwdHVyZV9xdWVzdGlv
bl9pbnB1dChxdWVzdCkKICAgICMjIHVwZGF0ZSBzY29yZQogICAgdXBkYXRl
KHF1ZXN0KQogICAgcmV0dXJuKHBhc3RlKGdldF9zY29yZShleG8pLCBxdWVz
dCRjYXB0dXJlcyRyZXBvbnNlLCBzZXAgPSAifHx8IikpCn0KCgpzZW5kX3Jl
cG9uc2VfaW5wdXQgPC0gZnVuY3Rpb24odGV4dCkgewogICAgdG1wIDwtIHN0
cnNwbGl0KHRleHQsICItPiIpW1sxXV0KICAgIHRtcDIgPC0gc3Ryc3BsaXQo
dG1wWzFdLCAiXFwuIilbWzFdXQogICAgZXhvX2lkIDwtIHRtcDJbMV0KICAg
IHFfaWQgPC0gdG1wMlsyXQogICAgZXhvIDwtIGdldF9leG8oZXhvX2lkKQog
ICAgaWYgKGlzLm5hKHRtcFsyXSkpIHsKICAgICAgICB0bXBbMl0gPC0gIiIK
ICAgIH0KICAgIHJlcG9uc2UgPC0gdG1wWzJdCiAgICAjIyBBZGQgcmVwb25z
ZQogICAgYWRkX3JlcG9uc2UoZXhvLCBxX2lkLCByZXBvbnNlKQogICAgcXVl
c3QgPC0gZXhvJHF1ZXN0aW9uc1tbcV9pZF1dCiAgICAjIyBDYXB0dXJlIGZv
ciByZXBvbnNlIGlzIHVwZGF0ZWQKICAgIGFkZF9jYXB0dXJlX3F1ZXN0aW9u
X2lucHV0KHF1ZXN0KQogICAgIyMgdXBkYXRlIHNjb3JlCiAgICB1cGRhdGUo
cXVlc3QpCiAgICByZXR1cm4ocGFzdGUoZ2V0X3Njb3JlKGV4byksIHF1ZXN0
JGNhcHR1cmVzJHJlcG9uc2UsIHNlcCA9ICJ8fHwiKSkKfQoKZ2V0X3Njb3Jl
X2J5X2lkIDwtIGZ1bmN0aW9uKGV4b19pZCkgewogICAgZ2V0X3Njb3JlKGdl
dF9leG8oZXhvX2lkKSkKfQoKZ2V0X25vdGUgPC0gZnVuY3Rpb24oZXhvKSB7
CiAgICBwYXN0ZTAoInNjb3JlID0gIiwKICAgICAgICByb3VuZChzdW0oc2Fw
cGx5KGV4byRxdWVzdGlvbnMsIAogICAgICAgICAgICBmdW5jdGlvbihxKSBt
YXgoMCwgZXZhbChwYXJzZSh0ZXh0ID0gcVtbInNjb3JlIl1dKSkpKSksIDIp
LAogICAgICAgICIvIiwgbGVuZ3RoKGV4byRxdWVzdGlvbnMpCiAgICApCn0K
CmdldF9zY29yZSA8LSBmdW5jdGlvbihleG8pIHsKICAgIHNjb3JlcyA8LSBj
aGFyYWN0ZXIoMCkKICAgIGZvciAocV9pZCBpbiBuYW1lcyhleG8kcXVlc3Rp
b25zKSkgewogICAgICAgIHNjb3JlcyA8LSBjKHNjb3JlcywgcGFzdGUwKHFf
aWQsICI9IiwgZXhvJHF1ZXN0aW9uc1tbcV9pZF1dW1sic2NvcmUiXV0pKQog
ICAgfQogICAgIyByZXR1cm4ocGFzdGUoc2NvcmVzLCBjb2xsYXBzZSA9ICI7
IikpCiAgICByZXR1cm4ocGFzdGUwKGdldF9ub3RlKGV4byksICI8YnIvPiIs
ICBmb3JtYXRfc2NvcmVzKHNjb3JlcykpKQp9Cgpmb3JtYXRfc2NvcmVzIDwt
IGZ1bmN0aW9uKHNjb3JlcywgZWx0X2J5X3JvdyA9IDEwKSB7CiAgICBuIDwt
IGxlbmd0aChzY29yZXMpCiAgICByb3dzIDwtIGlmIChuID49IGVsdF9ieV9y
b3cpIHsKICAgICAgICBhcHBseShtYXRyaXgoc2NvcmVzWzE6KG4gLSBuICUl
IGVsdF9ieV9yb3cpXSwgbnJvdyA9IGVsdF9ieV9yb3cpLCAyLAogICAgICAg
ICAgICBmdW5jdGlvbihpKSBwYXN0ZShpLCBjb2xsYXBzZSA9ICI7ICIpCiAg
ICAgICAgKQogICAgfSBlbHNlIHsKICAgICAgICBjKCkKICAgIH0KICAgIGlm
IChuICUlIGVsdF9ieV9yb3cgPiAwKSB7CiAgICAgICAgcm93cyA8LSBjKHJv
d3MsIHBhc3RlKHNjb3Jlc1soKG4gJS8lIGVsdF9ieV9yb3cpICogZWx0X2J5
X3JvdykgKwogICAgICAgICAoMToobiAlJSBlbHRfYnlfcm93KSldLCBjb2xs
YXBzZSA9ICI7ICIpKQogICAgfQogICAgcmV0dXJuKHBhc3RlKHJvd3MsIGNv
bGxhcHNlID0gIjxici8+IikpCn0KCmdldF9zY29yZXMgPC0gZnVuY3Rpb24o
KSB7CiAgICBleG9zIDwtIGdldCgiLmV4b0NxbHMiLCBlbnZpciA9IC5HbG9i
YWxFbnYpCiAgICBzY29yZXMgPC0gbGlzdCgpCiAgICBmb3IgKGlkIGluIHNl
dGRpZmYobmFtZXMoZXhvcyksICJpZCIpKSB7CiAgICAgICAgc2NvcmVzW1tp
ZF1dIDwtIGdldF9zY29yZShleG9zW1tpZF1dKQogICAgfQogICAgc2NvcmVz
Cn0KCmFkZF9xdWVzdGlvbnMgPC0gZnVuY3Rpb24oZXhvLCBxdWVzdHMpIHsK
ICAgIGZvciAoaWQgaW4gbmFtZXMocXVlc3RzKSkgewogICAgICAgIHF1ZXN0
IDwtIHF1ZXN0c1tbaWRdXQogICAgICAgIHN3aXRjaChxdWVzdFtbMV1dLAog
ICAgICAgICAgICBxdWl6eiA9IGFkZF9xdWVzdGlvbihleG8sIGlkLAogICAg
ICAgICAgICAgICAgbmV3X3F1ZXN0aW9uX3F1aXp6KGlkLCBxdWVzdFtbMl1d
KQogICAgICAgICAgICApLAogICAgICAgICAgICByYXcgPSBuZXdfcXVlc3Rp
b25faW5wdXQoaWQsIHF1ZXN0W1syXV0sIG1vZGUgPSBxdWVzdFtbMV1dKSwK
ICAgICAgICAgICAgcnZhbCA9ICwgcmV4cHIgPSBhZGRfcXVlc3Rpb24oZXhv
LCBpZCwKICAgICAgICAgICAgICAgIG5ld19xdWVzdGlvbl9pbnB1dChpZCwK
ICAgICAgICAgICAgICAgICAgICBxdWVzdFtbMl1dLAogICAgICAgICAgICAg
ICAgICAgIG1vZGUgPSBxdWVzdFtbMV1dLAogICAgICAgICAgICAgICAgICAg
IHJjb2RlID0gcXVlc3RbWzNdXQogICAgICAgICAgICAgICAgKQogICAgICAg
ICAgICApCiAgICAgICAgKQogICAgfQp9CgphZGRfcXVlc3Rpb24gPC0gZnVu
Y3Rpb24oZXhvLCBpZCwgcXVlc3QpIHsKICAgIGV4byRxdWVzdGlvbnNbW2lk
XV0gPC0gcXVlc3QKfQoKYWRkX3JlcG9uc2UgPC0gZnVuY3Rpb24oZXhvLCBp
ZCwgcmVwb25zZSkgewogICAgZXhvJHF1ZXN0aW9uc1tbaWRdXSRyZXBvbnNl
IDwtIHJlcG9uc2UKfQoKbmV3X3F1ZXN0aW9uIDwtIGZ1bmN0aW9uKG1vZGUs
IGlkICwgc29sdXRpb24pIHsKICAgIHN3aXRjaChtb2RlLAogICAgICAgIHF1
aXp6ID0gbmV3X3F1ZXN0aW9uX3F1aXp6KGlkLCBzb2x1dGlvbiksCiAgICAg
ICAgcmF3ID0gLCBydmFsID0gLCByZXhwciA9IG5ld19xdWVzdGlvbl9pbnB1
dChpZCwgc29sdXRpb24sIG1vZGUpCiAgICApCn0KCm5ld19xdWVzdGlvbl9x
dWl6eiA8LSBmdW5jdGlvbihpZCwgc29sdXRpb24pIHsKICAgIHF1ZXN0IDwt
IG5ld19lbnYoCiAgICAgICAgaWQgPSBpZCwKICAgICAgICBtb2RlID0gInF1
aXp6IiwKICAgICAgICByZXBvbnNlID0gY2hhcmFjdGVyKDApLCAjIHZlY3Rl
dXIgZGUgY2hvaXgKICAgICAgICBzb2x1dGlvbiA9IHNvbHV0aW9uLCAjIHZl
Y3RldXIgZGUgY2hvaXgKICAgICAgICBzY29yZSA9IHBhc3RlMCgiMC8iLCBs
ZW5ndGgoc29sdXRpb24pKQogICAgKQogICAgY2xhc3MocXVlc3QpIDwtIGMo
InF1ZXN0aW9uX3F1aXp6IiwgInF1ZXN0aW9uIiwgY2xhc3MocXVlc3QpKQog
ICAgcXVlc3QKfQoKbmV3X3F1ZXN0aW9uX2lucHV0IDwtIGZ1bmN0aW9uKAog
ICAgaWQsCiAgICBzb2x1dGlvbiwKICAgIG1vZGUgPSBjKCJyYXciLCAicnZh
bCIsICJyZXhwciIpLAogICAgcmNvZGUgPSAiIgopIHsKICAgIHF1ZXN0IDwt
IG5ld19lbnYoCiAgICAgICAgaWQgPSBpZCwKICAgICAgICByZXBvbnNlID0g
IiIsICMgQSBjb21wbMOpdGVyIHBhciBsJ3V0aWxpc2F0ZXVyCiAgICAgICAg
c29sdXRpb24gPSBzb2x1dGlvbiwgIyBleHByZXNzaW9uIGNoYXJhY3Rlcgog
ICAgICAgIG1vZGUgPSBtYXRjaC5hcmcobW9kZSksCiAgICAgICAgcmNvZGUg
PSByY29kZSwKICAgICAgICByZXBvbnNlX3Jjb2RlID0gIiIsCiAgICAgICAg
c2NvcmUgPSBwYXN0ZTAoIjAvIiwgbGVuZ3RoKHNvbHV0aW9uKSksCiAgICAg
ICAgY2FwdHVyZXMgPSBsaXN0KHJlcG9uc2UgPSAiIiwgc29sdXRpb24gPSAi
IikKICAgICkKICAgIGNsYXNzKHF1ZXN0KSA8LSBjKCJxdWVzdGlvbl9pbnB1
dCIsICJxdWVzdGlvbiIsIGNsYXNzKHF1ZXN0KSkKICAgIGlmIChxdWVzdCRt
b2RlICVpbiUgYygicnZhbCIsICJyZXhwciIpKSB7CiAgICAgICAgYWRkX2Nh
cHR1cmVfcXVlc3Rpb25faW5wdXQocXVlc3QsIG1vZGUgPSAic29sdXRpb24i
KQogICAgfQogICAgcXVlc3QKfQoKYWRkX2NhcHR1cmVfcXVlc3Rpb25faW5w
dXQgPC0gZnVuY3Rpb24ocXVlc3QsIG1vZGUgPSAicmVwb25zZSIpIHsKICAg
IHJlcyA8LSAiIgogICAgaWYgKHF1ZXN0JG1vZGUgJWluJSBjKCJydmFsIiwg
InJleHByIikpIHsKICAgICAgICByZXMgPC0gdHJ5Q2F0Y2goewogICAgICAg
ICAgICBldmFsKHBhcnNlKHRleHQgPSBwYXN0ZShxdWVzdCRyY29kZSwgcXVl
c3QkcmVwb25zZV9yY29kZSwgIlxuIikpKQogICAgICAgICAgICBwYXN0ZSgK
ICAgICAgICAgICAgICAgIGNhcHR1cmUub3V0cHV0KGV2YWwocGFyc2UodGV4
dCA9IHF1ZXN0W1ttb2RlXV0pKSksCiAgICAgICAgICAgICAgICBjb2xsYXBz
ZSA9ICJcbiIKICAgICAgICAgICAgKQogICAgICAgIH0sIGVycm9yID0gZnVu
Y3Rpb24oZSkgZSwKICAgICAgICAgICAgZmluYWxseSA9IHBhc3RlMCgiRXJy
b3IgaW4gIiwgcXVlc3RbW21vZGVdXSkKICAgICAgICApCiAgICB9CiAgICBx
dWVzdCRjYXB0dXJlc1tbbW9kZV1dIDwtIHJlcwp9Cgp1cGRhdGUucXVlc3Rp
b25fcXVpenogPC0gZnVuY3Rpb24ocXVlc3QpIHsKICAgIHF1ZXN0JHNjb3Jl
IDwtIHBhc3RlKGxlbmd0aChpbnRlcnNlY3QocXVlc3QkcmVwb25zZSwgcXVl
c3Qkc29sdXRpb24pKSAKICAgICAgICAtIGxlbmd0aChzZXRkaWZmKHF1ZXN0
JHJlcG9uc2UsIHF1ZXN0JHNvbHV0aW9uKSksCiAgICBsZW5ndGgocXVlc3Qk
c29sdXRpb24pLCBzZXAgPSAiLyIpCn0KCnVwZGF0ZS5xdWVzdGlvbl9pbnB1
dCA8LSBmdW5jdGlvbihxdWVzdCkgewogICAgcXVlc3Qkc2NvcmUgPC0gc3dp
dGNoKHF1ZXN0JG1vZGUsCiAgICAgICAgcmF3ID0gewogICAgICAgICAgICBw
YXN0ZShsZW5ndGgoaW50ZXJzZWN0KHF1ZXN0JHJlcG9uc2UsIHF1ZXN0JHNv
bHV0aW9uKSkKICAgICAgICAgICAgICAgIC0gbGVuZ3RoKHNldGRpZmYocXVl
c3QkcmVwb25zZSwgcXVlc3Qkc29sdXRpb24pKSwKICAgICAgICAgICAgbGVu
Z3RoKHF1ZXN0JHNvbHV0aW9uKSwgc2VwID0gIi8iKQogICAgICAgIH0sCiAg
ICAgICAgcnZhbCA9IHsKICAgICAgICAgICAgIyMgQ2hlY2sgc29sdXRpb24g
aWYgZXZlcnl0aGluZyBpcyBmaW5lCiAgICAgICAgICAgIGlmICghaXMuY2hh
cmFjdGVyKHF1ZXN0JGNhcHR1cmVzJHNvbHV0aW9uKSkgewogICAgICAgICAg
ICAgICAgYWRkX2NhcHR1cmVfcXVlc3Rpb25faW5wdXQocXVlc3QsIG1vZGUg
PSAic29sdXRpb24iKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgK
ICAgICAgICAgICAgICAgIGlzLmNoYXJhY3RlcihxdWVzdCRjYXB0dXJlcyRy
ZXBvbnNlKSAmJgogICAgICAgICAgICAgICAgaXMuY2hhcmFjdGVyKHF1ZXN0
JGNhcHR1cmVzJHNvbHV0aW9uKSAmJgogICAgICAgICAgICAgICAgcXVlc3Qk
Y2FwdHVyZXMkcmVwb25zZSA9PSBxdWVzdCRjYXB0dXJlcyRzb2x1dGlvbgog
ICAgICAgICAgICApCiAgICAgICAgICAgICAgICAiMS8xIgogICAgICAgICAg
ICBlbHNlIAogICAgICAgICAgICAgICAgIjAvMSIKICAgICAgICB9LAogICAg
ICAgIHJleHByID0gewogICAgICAgICAgICBxdWVzdF9zb2x1dGlvbiA8LSBh
cy5saXN0KHBhcnNlKHRleHQgPSBxdWVzdCRzb2x1dGlvbikpCiAgICAgICAg
ICAgIHF1ZXN0X3JlcG9uc2UgPC0gYXMubGlzdChwYXJzZSh0ZXh0ID0gcXVl
c3QkcmVwb25zZSkpCiAgICAgICAgICAgIHBhc3RlKGxlbmd0aChpbnRlcnNl
Y3QocXVlc3RfcmVwb25zZSwgcXVlc3Rfc29sdXRpb24pKQogICAgICAgICAg
ICAgICAgLSBsZW5ndGgoc2V0ZGlmZihxdWVzdF9yZXBvbnNlLCBxdWVzdF9z
b2x1dGlvbikpLAogICAgICAgICAgICBsZW5ndGgocXVlc3Rfc29sdXRpb24p
LCBzZXAgPSAiLyIpCiAgICAgICAgfQogICAgKQp9Cn0sIGVudmlyID0gLmZu
cykKaWYoISgnLmZucycgJWluJSBzZWFyY2goKSkpIGF0dGFjaCguZm5zKQpy
ZWdpc3Rlcl9lbnZfbWV0aG9kcygp
`))

    await webr_loading_increment();
     
     await webRConsole.webR.evalRVoid(atob(`CgoKYWRkX3RleHRfcXVlc3Rpb24oInByZXNNYXgucTFhLT5xdWl6ei0+YzJ8
fHxjNCIpCgphZGRfdGV4dF9xdWVzdGlvbigicHJlc01heC5xMWItPnF1aXp6
LT5jMXx8fGMyfHx8YzQiKQoKYWRkX3RleHRfcXVlc3Rpb24oInByZXNNYXgu
cTItPnF1aXp6LT5jMiIpCgphZGRfdGV4dF9xdWVzdGlvbigicHJlc01heC5x
My0+cXVpenotPmMyfHx8YzMiKQoKYWRkX3RleHRfcXVlc3Rpb24oInByZXNN
YXgucTQtPnF1aXp6LT5jMXx8fGMyfHx8YzN8fHxjNCIpCgphZGRfdGV4dF9x
dWVzdGlvbigiaW5kdXMucTFhLT5xdWl6ei0+YzF8fHxjMyIpCgphZGRfdGV4
dF9xdWVzdGlvbigiaW5kdXMucTFiLT5xdWl6ei0+YzIiKQoKYWRkX3RleHRf
cXVlc3Rpb24oImluZHVzLnEyYS0+cXVpenotPmM0IikKCmFkZF90ZXh0X3F1
ZXN0aW9uKCJpbmR1cy5xMmItPnF1aXp6LT5jMXx8fGMzIikKCmFkZF90ZXh0
X3F1ZXN0aW9uKCJpbmR1cy5xMy0+cXVpenotPmMyfHx8YzR8fHxjNSIpCgph
ZGRfdGV4dF9xdWVzdGlvbigiaW5kdXMucTQtPnF1aXp6LT5jMiIpCgphZGRf
dGV4dF9xdWVzdGlvbigiaW5kdXMucTUtPnF1aXp6LT5jMiIpCgphZGRfdGV4
dF9xdWVzdGlvbigiaW5kdXMucTYtPnF1aXp6LT5jMXx8fGMzIikKCmFkZF90
ZXh0X3F1ZXN0aW9uKCJlY2gucTYtPnF1aXp6LT5jMSIpCg==
`));
     
        globalThis.sendInputText = () => {
            var code = $("#textarea_webrin").val();
            webRConsole.stdin(code);
            sessionOut.insert({row: sessionOut.getLength(),column: 0}, code  + '\n');
            $("#textarea_webrin").val("");
        }
        globalThis.set_webrin = (code) => {
            $("#textarea_webrin").val(code);
            globalThis.sendInputText();
        }
        
     
      
        // Init 
        
await webRConsole.webR.evalRVoid("webr::install('asympTest');require(asympTest)");
await webr_loading_increment();
await webRConsole.webR.evalRVoid('options(device=webr::canvas)');
await webRConsole.webR.evalRVoid("webr::mount(mountpoint='/data', source='https://cqls.dyndoc.fr/users/Web/public/rcqls/Econo/rcqls.data')");
await webr_loading_increment();
// await webRConsole.webR.evalRVoid("webr::install('QuestionsCqls',repos='https://cqls.dyndoc.fr/users/Web/public/rcqls/repo')")



    
      /* Send input on Enter key */
      
      $("#run").click(function() {
        globalThis.sendInputText();
      });
      
      $("#clear").click(function() {
        sessionOut.setValue("> ");
      });
      
      $("#clear-first").click(function() {
        var code = ">" + sessionOut.getValue().split(/\n>/).slice(1).join("\n>");
        sessionOut.setValue(code);
      });
      
    </script>

<div id="webr-console-view">


<div class="ui internally celled grid">

    <div class="eight wide column" id="celledgrid-col1">
<h3><a href="https://docs.r-wasm.org/webr/latest/" target="_blank">WebR</a> Console 
<button class="blue circular ui icon button aide webr">
    <i class="question icon"></i>
</button>
</h3>
<div class="ui teal progress" id="webr_loading">
  <div class="bar">
    <div class="progress"></div>
  </div>
</div>
<div id="outWebr">
    
<pre id="ace_editor_webrout" style="margin:10px;width:100%;min-height:200px;border: 1px solid;">
</pre>


    
</div>
<!-- div class="ui menu" -->
    <div class="ui buttons">
        <button id="run" class="ui yellow icon button"><i class="play icon"></i>Exécuter</button>
        <button id="clear" class="ui red icon button"><i class="delete icon"></i>Tout</button>
        <button id="clear-first" class="ui orange icon button"><i class="delete icon"></i>Début</button>
        <button id="celledgrid-toggle-btn" class="mini circular ui icon button" data-tooltip="Voir/Cacher partie de droite"><i id="celledgrid-toggle-btn-icon" class="icon chevron right"></i></button>

    </div>
    <!-- div class="ui right aligned item" -->
    
    <!-- /div -->
<!-- /div -->

<div class="ui aide fluid popup webr">

    
<div class="ui list">

    
<div class="item">
    <div class="content">
        <div class="header">Introduction</div>
        <div class="description">
        
    Taper votre code R dans l'éditeur de texte du bas, exécuter-le et voir la sortie dédiée:
    <ul>
    <li>Editeur de texte du haut pour l'obtention des résultats</li>
    <li>Plot dans la partie de droite</li>
    </ul>
    
        </div>
    </div>
</div>

    
<div class="item">
    <div class="content">
        <div class="header">Exécuter code</div>
        <div class="description">
        Click sur <button class="ui yellow icon button"><i class="play icon"></i></button>
    ou <em>[Ctrl] + [R]</em>
    
        </div>
    </div>
</div>

    
<div class="item">
    <div class="content">
        <div class="header">Effacer toutes les sorties</div>
        <div class="description">
        Click sur <button class="ui red icon button"><i class="delete icon"></i></button>
    
        </div>
    </div>
</div>

    
<div class="item">
    <div class="content">
        <div class="header">Effacer la première sortie</div>
        <div class="description">
        Click sur <button class="ui orange icon button"><i class="delete icon"></i></button>
    
        </div>
    </div>
</div>

    
</div>

</div>

<div id="inWebr">
    
      <textarea id="textarea_webrin"  rows="5" cols="40%" placeholder="Instruction R..."></textarea><br/>
    
</div>

    </div>
    <div class="eight wide column" id="celledgrid-col2">

<h3>Sélection Jeu de données 
<button class="blue circular ui icon button aide dataset">
    <i class="question icon"></i>
</button>
</h3>

<div class="ui aide fluid popup dataset">

    
<div class="ui list">

    
<div class="item">
    <div class="content">
        <div class="header"></div>
        <div class="description">
        
    Sélectionner un jeu de données dans le menu déroulant
    
        </div>
    </div>
</div>

    
<div class="item">
    <div class="content">
        <div class="header"></div>
        <div class="description">
        
    Une fois sélectionné le jeu de données est exécuté dans la console WebR.
    
        </div>
    </div>
</div>

    
</div>

</div>


<div class="ui top attached tabular menu tabs">
<a class="active item" data-tab="l2">L2 (Stat Inf)</a><a class="item" data-tab="l3">L3 (Econométrie)</a>
</div>
<div class="ui bottom attached tab active segment" data-tab="l2">
  <select id="exoL2" class="ui fluid normal dropdown">
<option value="">choisir un jeu de données</option><option value="alfredN20">yA (Alfred, n=20)</option>
<option value="alfred">yA (Alfred)</option>
<option value="bernardN20">yB (Bernard, n=20)</option>
<option value="bernard">yB (Bernard)</option>
<option value="dictee">yD (dictée, n=30)</option>
<option value="dieteticien">AV, AP (diététicien, n=10), yD (diététicien, n=50)</option>
<option value="produitA">yA (industriel, n=1000)</option>
<option value="produitB">yB (industriel, n=1000)</option>
<option value="primeProdA">yQ (qualité Produit A)</option>
<option value="competence">yC (compétence)</option>
<option value="competenceN500">yC (compétence, n=500)</option>
<option value="pilote1N20">y1 (pilote 1, n=20)</option>
<option value="pilote1">y1 (pilote 1)</option>
<option value="pilote2">y2 (pilote 2)</option>
<option value="conduite">yF (femmes), yH (hommes)</option>
<option value="adjverbe">sc (scientifiques), litt (litteraires)</option>
<option value="machine">yM1 (machine 1), yM2 (machine 2)</option>
<option value="menu">yAV (Avant), yAP1 et yAP2 (Après)</option>
<option value="notes">yContC (continu C), yExamC (exam C), yExamD (exam D)</option>
<option value="chAffN20">yP1 (pays 1, n1=20), yP2 (pays 2, n2=20)</option>
<option value="chAff">yP1 (pays 1), yP2 (pays 2)</option>
<option value="chAff0405N20">y04 (2004, n1=20), y05 (2005, n2=20)</option>
<option value="chAff0405">y04 (2004), y05 (2005)</option></select>
  </div><div class="ui bottom attached tab segment" data-tab="l3">
  <select id="exoL3" class="ui fluid normal dropdown">
<option value="">choisir un jeu de données</option><option value="dataLM">dataLM (canada, champ, chomage, ecofict, initie, maison, voiture)</option>
<option value="phillips">phillips</option></select>
  </div>


<h3><a href="https://docs.r-wasm.org/webr/latest/" target="_blank">WebR</a> Plot</h3><div id="plot-container" style="background-color: rgba(100, 100, 100, 0.1);"></div>

    </div>

</div>


</div>



</div>

</div>

<script type="text/javascript">
if (typeof clipboardDemo == 'undefined') {
	clipboardDemo = new Clipboard('.clipboard');
	stateClip=false; //global variable
}
stateClip=false; //global variable
$(".clipboard").click(function(e) {stateClip=true;});
$(".demoR").click(function() {
  if(stateClip) {
    stateClip=false;
  } else {
    var state=$( this ).attr("state");
    var link_id=$( this ).attr("link_id");
    if(state=="on") {
      $("#code-"+link_id).hide();
      $("#session-"+link_id).show();
      $( this ).attr("state","off");
    } else {
      $("#code-"+link_id).show();
      $("#session-"+link_id).hide();
      $( this ).attr("state","on");
    }
  }
});
function prev_DemoRFigs(fig) {
  var curfig=demoRFigs[fig]['current'];
  var prevfig=demoRFigs[fig]['prev'][curfig];
  demoRFigs[fig]['figs'].forEach(function(e) {
    if(e == prevfig) {
      $("#img-"+fig+"-"+e).show();$("#code-"+fig+"-"+e).show();
    } else {
      $("#img-"+fig+"-"+e).hide();$("#code-"+fig+"-"+e).hide();
    }
  });
  demoRFigs[fig]['current']=prevfig;
}
function next_DemoRFigs(fig) {
  var curfig=demoRFigs[fig]['current'];
  var nextfig=demoRFigs[fig]['next'][curfig];
  demoRFigs[fig]['figs'].forEach(function(e) {
    if(e == nextfig) {
      $("#img-"+fig+"-"+e).show();$("#code-"+fig+"-"+e).show();
    } else {
      $("#img-"+fig+"-"+e).hide();$("#code-"+fig+"-"+e).hide();
    }
  });
  demoRFigs[fig]['current']=nextfig;
}
//init
$(".demoRSession").hide();
function getExoData(exo) {
  var code;
  switch (exo) {
  case "alfredN20":
    code="yA=c(0.144679564279082, 0.308391019822987, 0.165071844320451, 0.0810088511346089,-0.150489835962709, -0.0216344580330839, -0.255587942544298,0.0987153563164697, 0.592751352277294, -0.229624997435348, -0.216767323099697,-0.0970720818772463, 0.170505292061653, -0.0573236584450232,0.653375135601917, 0.178024688692504, 0.292787345192972, -0.165149721585414,-0.300802214354508, 0.32129751773001)";
    break;
  case "alfred":
    code="yA=c(0.144679564279082, 0.308391019822987, 0.165071844320451, 0.0810088511346089,-0.150489835962709, -0.0216344580330839, -0.255587942544298,0.0987153563164697, 0.592751352277294, -0.229624997435348, -0.216767323099697,-0.0970720818772463, 0.170505292061653, -0.0573236584450232,0.653375135601917, 0.178024688692504, 0.292787345192972, -0.165149721585414,-0.300802214354508, 0.32129751773001, 0.0805886239932639, 0.143171545682753,-0.00298066490980145, -0.255637645785468, 0.0928007482527018,-0.153861013155069, -0.091326084306205, 0.296172089667303, 0.00686887343119331,-0.596877687513186, -0.0584200940407693, 0.0720811015026169,0.0175687232410191, 0.153389781110694, -0.44979678290783, 0.213281328016978,-0.0386525306111942, -0.081768580854734, -0.165385713923966,-0.454948636494848, 0.262084533688519, -0.215753300244686, 0.173626814513985,-0.20016068068908, -0.255138748345693, 0.125329351017599, -0.326049545254994,0.207517749735126, 0.0704389198591811, -0.303221493327114)";
    break;
  case "dictee":
    code="yD=c(9, 10, 0, 1, 0, 5, 6, 10, 8, 1, 13, 9, 8, 3, 0, 0, 1, 0, 0, 0, 6, 9, 6, 8, 3, 5, 11, 5, 0, 0)";
    break;
  case "dieteticien":
    code="yD=c(-1, 6, 4, 7, 7, 3, 2, 6, 3, 5, 5, 7, 4, 4, 2, 4, 6, 6, 5, 3, 5, 5, 2, 7, 4, 5, 4, 3, 6, 7, 4, 6, 4, 5, 2, 6, 4, 6, 5, 5, 6, 4, 3, 2, 3, 6, 5, 7, 2, 4);AV=c(64,67,68,76,72,69,62,65,64,73);AP=c(65,61,64,69,65,66,60,59,61,68)";
    break;

  case "produitA":
      code="yA=c(0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,0,1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,1,1,0,1,0,0,1,0,0,0,0,1,0,1,0,1,0,0,0,1,1,0,1,0,1,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,1,0,0,0,0,1,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,1,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,1,0,1,0,0,0,0,0,1,1,0,0,1,1,1,0,0,1,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,0,0,1,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1,1,0,1,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,1,0,1,0,0,1,1,0,1,0,0,0,0,1,0,0,0,0,1,1,0,0,0,1,0,0,0,1,1,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,1,0,0,0,1,1,0,1,1,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,1,1,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,1,0,1,0,0,0,0);"
      break;

    case "produitB":
      code="yB=c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,2,2,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,1,0,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,0,2,0,0,2,0,0,0,2,0,2,2,2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,3,0,0,0,0,0,3,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,0,0,0,3,0,1,0,2,0,0,0,0,2,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,3,0,0,1,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,0,1,0,2,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,3,0,0,0,0,0,1,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);"
      break;

    case "primeProdA":
      code="yQ=c(9,4,3,7,6,8,2,7,3,9,9,4,8,9,4,8,10,4,9,5,2,7,2,3,2,4,9,6,10,8,5,5,5,5,10,7,4,4,4,4,6,8,2,8,9,5,7,8,6,4,8,6,6,5,3,7,4,5,2,4,6,8,3,9,5,5,9,5,10,5,4,4,4,2,6,8,2,5,10,8,6,9,8,5,7,10,6,8,7,7,7,3,7,8,6,9,6,6,8,7,8,7,8,10,6,8,5,9,4,10,7,9,4,7,4,7,10,4,2,5,7,3,5,8,7,9,6,3,6,2,10,9,10,10,10,4,6,7,9,10,3,10,3,2,9,5,6,9,8,9,7,10,6,5,4,9,5,6,4,2,6,7,5,6,10,8,6,5,9,7,2,2,2,8,9,6,3,8,7,6,3,8,10,2,2,8,9,10,9,8,2,7,7,10,3,3,2,9,7,6);"
      break;

    case "competence":
      code="yC=c(0.3452,0.3619,0.2833,-0.0427,0.079,-0.5758,-0.7199,0.1819,0.0444,-0.0195,-0.3482,0.2607,-0.2111,-0.2889,-0.1782,0.0806,0.5698,0.2164,-0.0552,-0.4348,-0.085,0.0572,-0.1577,0.0853,0.3121,0.1269,-0.178,-0.1786,-0.4814,-0.0719)";
      break;
    case "competenceN500":
        code ="yC=c(0.3452,0.3619,0.2833,-0.0427,0.079,-0.5758,-0.7199,0.1819,0.0444,-0.0195,-0.3482,0.2607,-0.2111,-0.2889,-0.1782,0.0806,0.5698,0.2164,-0.0552,-0.4348,-0.085,0.0572,-0.1577,0.0853,0.3121,0.1269,-0.178,-0.1786,-0.4814,-0.0719,-0.0439,0.525,0.2029,0.003,-0.3284,0.4347,0.2127,-0.3373,0.1468,0.1314,0.0278,-0.4716,-0.3762,1.0421,0.1106,0.1952,-0.5956,-0.0089,0.0567,0.1482,-0.1651,0.0666,0.0445,0.0326,0.9059,0.1556,-0.3532,0.0866,-0.2541,0.4386,0.6504,0.3769,0.0087,-0.125,-0.1034,0.192,0.175,0.2664,-0.4811,-0.3155,0.059,0.3445,-0.6046,0.0786,-0.2335,0.4871,-0.5233,0.1762,-0.3234,0.4472,-0.3584,0.29,0.2697,-0.2292,0.1676,-0.0659,0.1506,0.0368,0.1302,-0.6586,0.2778,0.527,-0.2744,-0.1959,-0.0875,-0.149,0.1976,-0.4146,-0.4592,-0.2463,0.3366,0.2265,-0.0501,-0.0412,-0.2602,-0.0141,-0.346,-0.3419,-0.5036,-0.3809,-0.1486,0.3456,-0.0447,-0.1803,-0.192,0.1139,0.2088,0.1214,-0.1913,0.0188,-0.1707,-0.5467,0.0129,0.4636,-0.0492,-0.2122,0.4382,0.0045,-0.0681,0.0225,-0.474,0.1432,0.2018,0.4288,0.3178,-0.0121,0.2112,0.2331,0.2716,-0.1038,-0.1212,-0.0492,0.714,0.2594,-0.2113,-0.0883,-0.4557,-0.1166,0.1571,0.1569,0.0483,-0.2085,0.0884,-0.034,0.3878,-0.4485,0.1938,-0.1853,0.2563,-0.0741,0.3787,0.6373,-0.1065,0.0321,0.1355,0.3339,-0.3051,0.0494,0.3614,-0.1549,-0.2874,-0.2183,0.0198,-0.4457,-0.4614,0.0964,-0.1569,0.1148,-0.3795,-0.1403,0.0243,0.2048,0.4166,-0.1778,0.0659,0.0841,0.5647,0.5706,-0.0363,0.117,0.1478,0.4958,0.3579,0.2398,0.3305,0.2321,-0.1975,-0.4994,0.3278,-0.3198,-0.1338,-0.3128,0.1616,0.066,-0.139,-0.1319,-0.0267,0.4052,-0.1646,0.0367,-0.4976,-0.1752,0.2906,-0.0028,0.1288,0.221,0.2225,-0.076,0.1318,-0.2037,0.0634,0.2756,-0.0207,0.4706,0.5199,-0.1062,-0.1733,0.0974,-0.15,0.0656,-0.3681,0.2279,0.2775,-0.348,-0.077,0.2319,0.0672,0.2479,-0.0281,-0.1434,-0.1124,0.0864,-0.1426,0.0011,-0.29,-0.1101,-0.2297,0.4812,-0.1101,0.0163,0.0984,0.3576,-0.1897,0.6369,-0.0888,0.0961,0.4847,-0.1828,0.2686,-0.1555,-0.1664,-0.1125,0.1993,-0.3268,0.4213,-0.2599,0.3225,0.3241,-0.428,0.4507,-0.1645,0.0112,0.4105,0.0446,-0.2671,0.1818,0.14,0.2755,-0.0693,0.1108,-0.4736,0.2035,0.1057,-0.0133,0.2255,0.1392,0.0958,-0.1785,-0.2401,0.2066,0.1689,-0.0839,0.3356,0.0452,-0.0666,0.1421,-0.0998,-0.3763,-0.1811,0.0762,-0.1245,0.4276,-0.6499,-0.0592,0.2191,0.3591,0.4018,0.2062,0.4773,-0.0179,-0.2909,-0.3628,0.7379,0.5717,0.1715,-0.2861,-0.1892,-0.2028,-0.1116,-0.4121,-0.1755,-0.3829,0.3792,0.3452,0.1751,-0.2577,-0.1563,0.1928,0.1399,0.0576,-0.064,0.2678,-0.0405,-0.3628,0.1698,-0.269,-0.0131,-0.0408,-0.1439,-0.011,-0.1186,-0.0739,0.1042,-0.1817,0.2191,0.2018,-0.1566,0.0205,0.0504,0.1474,-0.0452,0.5772,0.2819,-0.0068,-0.1426,-0.1005,0.2617,0.0035,-0.2446,0.565,-0.1618,-0.3977,-0.0468,-0.0834,0.1421,-0.3733,-0.293,0.0707,0.168,-0.3612,0.0016,0.0542,-0.3185,0.3122,-0.1556,-0.3693,0.1983,0.2966,-0.1739,-0.4622,0.4013,0.3197,-0.2815,0.0424,-0.2837,0.2519,0.1854,0.5809,-0.367,-0.5653,-0.1107,0.037,-0.0747,-0.3508,0.0394,0.1149,-0.5456,0.5745,-0.1099,-0.2953,0.4483,0.1441,-0.1433,0.0983,-0.5089,0.671,0.3642,-0.7009,-0.1841,-0.2025,-0.2768,-0.2617,-0.4405,-0.0446,0.4652,-0.1413,0.4053,-0.242,0.2403,0.0345,0.4613,0.6622,-0.1194,-0.2871,-0.2504,0.6364,0.093,0.0452,0.1965,-0.1558,0.4283,0.2684,-0.1757,0.1015,0.1034,0.063,-0.3776,-0.0129,-0.0613,0.2489,0.2707,-0.067,0.1415,0.5811,0.2137,-0.257,0.1729,-0.0277,0.1387,0.2136,0.169,0.1478,-0.157,-0.5789,0.2378,-0.2675,-0.2812,0.0968,-0.2575,0.1706,-0.5129,-0.1205,0.3264,-0.1776,0.1641,0.0122,-0.0723,-0.3146,-0.0663,-0.5428,-0.3937,0.0784,-0.6184,0.018,0.1674,0.3295,0.0153,0.3676,-0.2089,0.1756,-0.3052,-0.5301,0.1752,-0.0773,0.0979,0.3483,-0.1393,0.3292,0.0988,-0.0622,-0.0702,0.1341,0.2778,-0.0795,-0.1076,-0.2658,-0.1247,-0.0267,0.4944,-0.3046)";
       break;

    case "pilote1N20":
      code="y1=c(47.89674,50.04087,54.5324,54.36718,48.80645,51.44077,49.72669,44.81843,50.3791,48.32037,53.5515,50.38611,50.37899,49.44585,50.47262,50.66881,50.44251,50.10745,47.43873,51.17308);"
      break;

    case "pilote1":
      code="y1=c(47.89674,50.04087,54.5324,54.36718,48.80645,51.44077,49.72669,44.81843,50.3791,48.32037,53.5515,50.38611,50.37899,49.44585,50.47262,50.66881,50.44251,50.10745,47.43873,51.17308,51.1604,50.06874,48.85899,52.08231,49.59702,52.87073,50.63278,50.04054,53.13216,50.13489,53.72466,50.48863,48.83423,51.93978,49.19886,52.67034,49.2136,48.35678,49.43116,48.95199);"
      break;

    case "pilote2":
      code="y2=c(51.89371,51.35814,52.16305,51.83228,52.97653,51.43513,50.8937,51.50756,51.54468,52.22917,51.21122,52.96252,51.61797,52.40225,50.21097,51.73468,52.1436,52.57952,51.60721,52.15696,51.51422,53.23509,53.55053,52.62854,51.3968,52.51582,51.7682,53.42508,52.59148,51.55015,53.02435,52.20928,52.13902,52.04843,53.60312,50.48255,51.36794,52.73886,50.4655,51.92149,50.82357,53.11825,52.30076,49.99984,52.47019,51.9189,52.68014,51.25526,53.55974,52.44708);"
      break;

    case "bernardN20":
      code="yB=c(0.02483016,0.09379133,0.145188,-0.04969999,-0.1532143,0.1208757,-0.112933,-0.3452917,-0.007106278,0.1220161,-0.1919765,-0.3684244,0.1882093,-0.1190619,-0.2020528,0.2495189,-0.3013964,0.1123033,0.2164801,0.2393351);"
      break;

    case "bernard":
      code="yB=c(0.02483016,0.09379133,0.145188,-0.04969999,-0.1532143,0.1208757,-0.112933,-0.3452917,-0.007106278,0.1220161,-0.1919765,-0.3684244,0.1882093,-0.1190619,-0.2020528,0.2495189,-0.3013964,0.1123033,0.2164801,0.2393351,0.1428402,-0.323352,0.04930722,-0.02417904,0.1530558,0.1237836,-0.006933568,-0.06470596,0.1438609,0.02115967,-0.1333253,0.3044679,0.04528947,0.06454683,0.03938363,0.4622106,-0.1950227,-0.009857142,0.08429325,-0.04374064,-0.278324,0.3768047,-0.1410857,-0.01711132,0.04389444,0.07555481,0.2506217,0.3180829,0.005132367,0.0152481,0.2962752,-0.1621414,0.06079287,0.09097692,0.1198565,0.310566,-0.1467855,0.06196827,-0.1821278,-0.1878903);"
      break;

    case "conduite":
      code="yH=c(24,28,29,29,34,36,40,41,60);yF=c(21,31,34,37,38,39,42,43,44,50,51);"
      break;

    case "adjverbe":
      code="sc=c(1.04,0.93,0.75,0.33,1.62,0.76,0.97,1.21,0.8,1.18);litt=c(1.32,2.3,1.98,0.59,1.02,0.88,0.92,1.39,1.95,1.25);"
      break;

    case "machine":
      code="yM1=c(1844,1828,1837,1833,1831,1818,1836,1837,1840,1820,1845,1815,1831,1839,1824,1839,1836,1840,1822,1824,1820,1839,1849,1846,1817,1822,1832,1846,1832,1834,1847,1828,1809,1833,1830,1824,1834,1842,1837,1818,1812,1825,1839,1840,1817,1827,1827,1842,1846,1839,1822,1816,1834,1810,1826,1836,1834,1839,1832,1827,1847,1842,1844,1831,1840,1823,1828,1822,1804,1821,1823,1846,1836,1823,1831,1810,1838,1844,1830,1830,1829,1807,1797,1814,1807,1844,1834,1827,1841,1830,1830,1834,1840,1832,1844,1815,1825,1821,1840,1821);yM2=c(2025,2045,2017,2024,2016,2025,2023,2020,2008,2025,2017,2014,2024,2028,2009,2023,2024,2034,2023,2024,2029,2032,2013,2017,2019,2022,2023,2005,2031,2012,2014,2032,2018,2022,2035,2024,2034,2012,2017,2015,2020,2015,2018,2020,2033,2025,2026,2026,2023,2014);"
      break;

    case "menu":
      code="yAV=c(8,7,6,7,9,7,6,4,7,5,8,7,6,6,6,6,7,5,7,6,7,7,8,5,4,7,6,5,7,6,8,6,7,7,7,8,5,8,5,5);yAP1=c(9,9,9,6,7,7,9,6,8,6,10,11,6,9,8,8,6,10,7,10,6,8,7,8,9,6,9,9,6,7);yAP2=c(8,10,8,8,9,8,9,5,10,6,10,7,7,6,6,7,11,7,12,6,7,7,10,6,7,7,7,5,8,8,10,6,9,8,8,9,5,10,7,8);"
      break;

    case "notes":
      code="yContC=c(16,16,12,16,11,10,15,19,12,14,17,16,12,10,17,16,12,14,11,16,18,20,13,14,9,10,18,7,6,10,17,18,11,17,14,16,12,12,13,13,12,16,11,15,19,14,16,13,17,18);yExamC=c(14,17,15,13,13,13,12,16,13,15,12,14,13,15,17,15,17,13,13,12,15,14,12,13,9,10,16,11,16,13,13,14,13,15,11,16,14,10,8,15,10,12,12,12,15,10,15,9,13,11);yExamD=c(13,13,11,10,13,11,12,11,9,13,10,11,12,14,11,11,10,17,10,7,17,11,9,10,14,11,9,11,10,10,12,11,12,12,10,9,12,12,10,11,8,5,14,9,12,11,11,9,11,11);"
      break;

    case "chAffN20":
      code="yP1=c(98.83,96.56,86.08,84.08,93.68,106.74,93.42,104.04,99.24,87.47,117.65,115.26,109.33,92.71,105.48,93.09,106.59,82.92,96.31,87.99);yP2=c(63.89,72.36,88.48,74.28,71.63,82.45,67.42,76.01,74.33,77.81,71.67,72.38,80.33,77.67,67.29,73.98,65.97,76.65,74.02,88.96);"
      break;

    case "chAff":
      code="yP1=c(98.83,96.56,86.08,84.08,93.68,106.74,93.42,104.04,99.24,87.47,117.65,115.26,109.33,92.71,105.48,93.09,106.59,82.92,96.31,87.99,99.77,111.22,106.49,100.8,109.97,96.91,83.39,101.57,100.1,110.07,94.03,114.85,105.3,106.5,88.68,100.94,98.4,101.98,112.11,79.68);yP2=c(63.89,72.36,88.48,74.28,71.63,82.45,67.42,76.01,74.33,77.81,71.67,72.38,80.33,77.67,67.29,73.98,65.97,76.65,74.02,88.96,71.19,81.9,75.03,80.35,86.16,73.15,73.94,63.95,79.94,59.04,67.5,77.15,74.01,77.45,78.13,74.46,96.59,80,78.19,72.97);"
      break;

    case "chAff0405N20":
      code="y04=c(84.03,95.47,88.89,93.09,87.24,90,86.85,86.61,73.24,73.88,97.2,96.47,85.61,64.47,67.98,78.2,86.76,81.73,74.35,83.55);y05=c(98.83,96.56,86.08,84.08,93.68,106.74,93.42,104.04,99.24,87.47,117.65,115.26,109.33,92.71,105.48,93.09,106.59,82.92,96.31,87.99);"
      break;

    case "chAff0405":
      code="y04=c(84.03,95.47,88.89,93.09,87.24,90,86.85,86.61,73.24,73.88,97.2,96.47,85.61,64.47,67.98,78.2,86.76,81.73,74.35,83.55,85.15,76.67,87.75,84.52,104.08,72.72,101.8,87.52,86.61,89.96,76.96,95.11,70.88,89.79,87.29,83.36,73.73,79.94,91.97,100.07);y05=c(98.83,96.56,86.08,84.08,93.68,106.74,93.42,104.04,99.24,87.47,117.65,115.26,109.33,92.71,105.48,93.09,106.59,82.92,96.31,87.99,99.77,111.22,106.49,100.8,109.97,96.91,83.39,101.57,100.1,110.07,94.03,114.85,105.3,106.5,88.68,100.94,98.4,101.98,112.11,79.68);"
      break;
  }
  return code;
}
$('.ui.answer.accordion').accordion();
// is connected in question live?
function question_live_connected() {
    return ($("#question-live-status").val() != undefined && $("#question-live-status").val() == "green");
}

function question_live_session() {
    return {email: $("#question-live-email").val() + $("#question-live-email-dropdown").dropdown("get value"), qlid: $("#question-live-id").val()};
}

function send_reponse_quizz(exo, question) {
    var reponse = [];
    $("input.quizz[type=checkbox][exo='" + exo + "'][question='" + question +"']").each(function() {
        // console.log($(this).attr("exo") + " " + $(this).attr("name") + " " + $(this).prop("checked"));
        if($(this).prop("checked")) {
            reponse.push($(this).attr("name"));
        }
    })
    if(question_live_connected()) {
        var answer = reponse.sort().join("-");
        var session = question_live_session();
        console.log("connected: " + answer + " sent");
        $.post(
            "/dynworld/mongo/live/salon/send_reponse_question",
            {qlid: session['qlid'], email: session['email'] , exo: exo, question: question, reponse: answer},
            function(res) {
                //alert(res);
                var data = res.split("___|||___");
                $("#question-live-message").html(data[1]);
            }
        )
    } else {
        var answer = reponse.sort().join("|||");
        // console.log("send_reponse_quizz('" + exo + "." + question + "->" + answer + "')");
        var score = globalThis.evalRCode("send_reponse_quizz('" + exo + "." + question + "->" + answer + "')");
        score.then(function(result) {
            // console.log("score=" + result["type"] + "->" + result["values"]);
            $("#questions-result-" + exo).html(result["values"]);
        });
    }
}

function send_reponse_textarea(exo, question) {
    var answer = $("#questions-textarea-" + exo + "-" + question).val();
    
    // console.log("send_reponse_textarea('" + exo + "." + question + "->" + answer + "')");
    var score = globalThis.evalRCode("send_reponse_textarea('" + exo + "." + question + "->" + answer + "')");
    score.then(function(result) {
        // console.log("result=" + result["type"] + "->" + result["values"]);
        // console.log(result["values"][0]);
        var results = (result["values"][0]).split("|||");
        $("#echo-questions-textarea-" + exo + "-" + question).html(results[1]);
        if(question_live_connected()) {
            var session = question_live_session();
            $.post(
                "/dynworld/mongo/live/salon/send_reponse_question",
                {qlid: session['qlid'], email: session['email'] , exo: exo, question: question, reponse: results[1]},
                function(res) {
                    var data = res.split("___|||___");
                    $("#question-live-message").html(data[1]);
                }
            )
        } else {
            $("#questions-result-" + exo).html(results[0]);
        }
    });

}

function send_reponse_input(exo, question) {
    console.log("send reponse input for questions-input-" + exo + "-" + question);
    var answer = $("#questions-input-" + exo + "-" + question).val();
    
    // console.log("send_reponse_input('" + exo + "." + question + "->" + answer + "')");
    var score = globalThis.evalRCode("send_reponse_input('" + exo + "." + question + "->" + answer + "')");
    score.then(function(result) {
        // console.log("result=" + result["type"] + "->" + result["values"]);
        // console.log(result["values"][0]);
        var results = (result["values"][0]).split("|||");
        $("#echo-questions-input-" + exo + "-" + question).html(results[1]);
        if(question_live_connected()) {
            var session = question_live_session();
            $.post(
                "/dynworld/mongo/live/salon/send_reponse_question",
                {qlid: session['qlid'], email: session['email'] , exo: exo, question: question, reponse: results[1]},
                function(res) {
                    var data = res.split("___|||___");
                    $("#question-live-message").html(data[1]);
                }
            )
        } else {
            $("#questions-result-" + exo).html(results[0]);
        }
    });

}

function update_questions_score(exo) {
    if($("#questions-result-" + exo).html() == "") {
        console.log("get_score_by_id('" + exo +"')");
        var score = globalThis.evalRCode("get_score_by_id('" + exo +"')");
        score.then(function(result) {
            console.log("score=" + result["type"] + "->" + result["values"]);
            $("#questions-result-" + exo).html(result["values"]);
        });
    }
}

function update_scores() {
    var scores = globalThis.evalRCode("get_scores()");
    scores.then(function(result) {
        console.log("score=" + result["type"] + "->" + result["names"] + "->" + result["values"]);
        //$("#questions-result-" + exo).html(result["values"]);
    });
    //$("#questions-result-" + exo)
}

$('.ui.checkbox')
  .checkbox()
;

// update when any checkbox is changed
$('.questions.quizz[type=checkbox]').change(function () {
	var exo = $(this).attr("exo");
	var question = $(this).attr("question");
	console.log(exo + "." + question + " changed");
	send_reponse_quizz(exo,question);
});
$("#ok_answer_switcher").click(function() {

ok_answer_switch();

});
function ok_answer_switch() {
    $(".ok.answer").toggle();
}
ok_answer_switch();
$("#question-live-email-dropdown").dropdown("set selected", "@etu.univ-grenoble-alpes.fr");

$('#question-live-toggle')
  .popup({
    target: $("#webr-top-menu"),
    popup: $("#question-live-popup"),
    on: 'click',
    position   : 'bottom center'
  })
;

$("#question-live-go").click(function() {
    var email = $("#question-live-email").val() + $("#question-live-email-dropdown").dropdown("get value");
    var qlid = $("#question-live-id").val();
    $.get(
        "/dynworld/mongo/live/salon/connect",
        {email: email, qlid: qlid},
        function(res) {
            var old_status = $("#question-live-status").val();
            if(res != old_status) {
                $("#question-live-go").removeClass(old_status).addClass(res);
                $("#question-live-status").val(res);
            }
        }
    )
});

$("#question-live-close").click(function() {
    var email = $("#question-live-email").val() + $("#question-live-email-dropdown").dropdown("get value");
    var qlid = $("#question-live-id").val();
    $.get(
        "/dynworld/mongo/live/salon/disconnect",
        {email: email, qlid: qlid},
        function(res) {
            var old_status = $("#question-live-status").val();
            if(res != old_status) {
                $("#question-live-go").removeClass(old_status).addClass(res);
                $("#question-live-status").val(res);
            }
        }
    )
});
$("#questions-btn-presMax").click(function() {
		update_questions_score("presMax");
		$("#questions-result-presMax-toggle").toggle();
	});
	$("#questions-result-presMax-toggle").hide();
$("#ok_max_pop_answer").click(function() {
$(".ok_max_pop").toggle()
});
$(".ok_max_pop").hide();
$("#ok_max_ech_answer").click(function() {
$(".ok_max_ech").toggle()
});
$(".ok_max_ech").hide();
$("#ok_max_2echs_answer").click(function() {
$(".ok_max_2echs").toggle()
});
$(".ok_max_2echs").hide();
$("#ok_max_autres_pbs_answer").click(function() {
$(".ok_max_autres_pbs").toggle()
});
$(".ok_max_autres_pbs").hide();
$("#questions-btn-indus").click(function() {
		update_questions_score("indus");
		$("#questions-result-indus-toggle").toggle();
	});
	$("#questions-result-indus-toggle").hide();
$("#ok_prodAB_q1_answer").click(function() {
$(".ok_prodAB_q1").toggle()
});
$(".ok_prodAB_q1").hide();
$("#ok_prodAB_q2_answer").click(function() {
$(".ok_prodAB_q2").toggle()
});
$(".ok_prodAB_q2").hide();
$("#ok_prodAB_q3_answer").click(function() {
$(".ok_prodAB_q3").toggle()
});
$(".ok_prodAB_q3").hide();
$("#ok_prodAB_q4_answer").click(function() {
$(".ok_prodAB_q4").toggle()
});
$(".ok_prodAB_q4").hide();
$("#ok_prodAB_q5_answer").click(function() {
$(".ok_prodAB_q5").toggle()
});
$(".ok_prodAB_q5").hide();
$("#ok_prodAB_q6_answer").click(function() {
$(".ok_prodAB_q6").toggle()
});
$(".ok_prodAB_q6").hide();
$("#questions-btn-ech").click(function() {
		update_questions_score("ech");
		$("#questions-result-ech-toggle").toggle();
	});
	$("#questions-result-ech-toggle").hide();
$("#ok_procEch_q1_answer").click(function() {
$(".ok_procEch_q1").toggle()
});
$(".ok_procEch_q1").hide();
$("#ok_procEch_q2_answer").click(function() {
$(".ok_procEch_q2").toggle()
});
$(".ok_procEch_q2").hide();
$("#ok_procEch_q3_answer").click(function() {
$(".ok_procEch_q3").toggle()
});
$(".ok_procEch_q3").hide();
$("#ok_procEch_q4_answer").click(function() {
$(".ok_procEch_q4").toggle()
});
$(".ok_procEch_q4").hide();
$("#ok_procEch_q5_answer").click(function() {
$(".ok_procEch_q5").toggle()
});
$(".ok_procEch_q5").hide();
$("#ok_maxICSuite_q1_answer").click(function() {
$(".ok_maxICSuite_q1").toggle()
});
$(".ok_maxICSuite_q1").hide();
$("#ok_maxICSuite_q2_answer").click(function() {
$(".ok_maxICSuite_q2").toggle()
});
$(".ok_maxICSuite_q2").hide();
$("#ok_maxIC_toggle").click(function() {
;$(".ok_maxIC").toggle();$(".hidden_ok_maxIC").toggle();
});
$(".ok_maxIC").hide();$(".hidden_ok_maxIC").show();
$("#ok_maxICSuite_q3_answer").click(function() {
$(".ok_maxICSuite_q3").toggle()
});
$(".ok_maxICSuite_q3").hide();
$("#ok_maxICSuite_q4_answer").click(function() {
$(".ok_maxICSuite_q4").toggle()
});
$(".ok_maxICSuite_q4").hide();
$("#ok_pValProdAB_q1_answer").click(function() {
$(".ok_pValProdAB_q1").toggle()
});
$(".ok_pValProdAB_q1").hide();
$("#ok_pValProdAB_q2_answer").click(function() {
$(".ok_pValProdAB_q2").toggle()
});
$(".ok_pValProdAB_q2").hide();
$(".button.aide.webr").popup({popup: '.aide.popup.webr', on: 'hover',inline: true, position: "bottom left", lastResort: "bottom left", variation: "large"});
var editor_webrout = ace.edit("ace_editor_webrout");
      editor_webrout.setOptions({
        //autoScrollEditorIntoView: true,
        enableBasicAutocompletion: true,
        enableSnippets: true
      });
      editor_webrout.setTheme("ace/theme/solarized_light");
      editor_webrout.session.setMode("ace/mode/r");
      //editor_webrout.session.setValue("");
      editor_webrout.setAutoScrollEditorIntoView(true);
      editor_webrout.setOption("maxLines", 30);
editor_webrout.commands.addCommand({
    name: 'run',
    bindKey: {mac: "Command-R", win: "Ctrl-R"},
    exec: function(editor) {
        var text=editor.getSession().getValue();
        
        var code=editor.getSelectedText();
        globalThis.set_webrin(code);
    ;
    }
});
$("#celledgrid-toggle-btn").click(function() {
  if ( $('#celledgrid-col1').is( ".eight.wide.column" ) ) {
    $('#celledgrid-col1').removeClass("eight wide column").addClass("sixteen wide column");
    $('#celledgrid-col2').removeClass("eight wide column").addClass("zero wide column");
    $('#celledgrid-col2').hide();
    $('#celledgrid-toggle-btn-icon').removeClass("icon chevron right").addClass("icon chevron left");
  } else {
    $('#celledgrid-col1').removeClass("sixteen wide column").addClass("eight wide column");
    $('#celledgrid-col2').removeClass("zero wide column").addClass("eight wide column");
    $('#celledgrid-col2').show();
    $('#celledgrid-toggle-btn-icon').removeClass("icon chevron left").addClass("icon chevron right");
  }
});
$("#textarea_webrin").keypress("r",function(e) {
        if(e.ctrlKey) {
            globalThis.sendInputText();
        }
    });
    function webr_loading_increment() {
        $('#webr_loading').progress("increment");
        if($("#webr-btn-switch").length == 1) {
            console.log($("#webr_loading").progress("get value") + " == " + $("#webr_loading").progress("get total"));
            if($("#webr_loading").progress("get value") == $("#webr_loading").progress("get total")) {
                $("#webr-btn-switch").removeClass("ui red button").addClass("ui green button");
            }
        }
    }
    
    $('#webr_loading')
      .progress({total: 3})
    ;
$(".button.aide.dataset").popup({popup: '.aide.popup.dataset', on: 'hover',inline: true, position: "bottom left", lastResort: "bottom left", variation: "large"});
$("#exoL2").dropdown({
  allowReselection: true,
  placeholder: "auto",
  on: "click",
  onChange: function(value, text, $selectedItem) {
    // custom action
    
    globalThis.set_webrin(getExoData(value));
    ;
  } 
});
$("#exoL3").dropdown({
  allowReselection: true,
  placeholder: "auto",
  on: "click",
  onChange: function(value, text, $selectedItem) {
    // custom action
    
    globalThis.set_webrin("load('/data/"+value+".RData')");
    ;
  } 
});
$('.tabs .item')
  .tab()
;
function webr_switch_state(state) {
    $("#webr-view-state").val(state);
    if (state == "main") {
        $("#webr-main-view").show();
        $("#webr-console-view").hide();
        $(".webrmenu").show();
    } else {
        $("#webr-console-view").show();
        // Weird: need to activate ace editors
        ace.edit("ace_editor_webrout").resize();
        
        $("#webr-main-view").hide();
        $(".webrmenu").hide();
    }
}

$("#webr-btn-switch").click(function() {
    if( $("#webr-view-state").val() == "main") {
        webr_switch_state("console");
    } else {
        webr_switch_state("main");
    }
})

webr_switch_state("main");
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


</body>
</html>
